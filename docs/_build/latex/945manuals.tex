%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{945 Manuals}
\date{Oct 21, 2020}
\release{2020.10.21}
\author{945 Team}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{Odoo Developer Training}
\label{\detokenize{technical:odoo-developer-training}}\label{\detokenize{technical::doc}}
From Basis to First Module


\section{OCA Days \sphinxhyphen{} 2020}
\label{\detokenize{technical:oca-days-2020}}
\noindent{\hspace*{\fill}\sphinxincludegraphics{{oca-days-logo}.png}\hspace*{\fill}}


\section{Luis Felipe Miléo}
\label{\detokenize{technical:luis-felipe-mileo}}\begin{itemize}
\item {} 
Co\sphinxhyphen{}founder and CEO at KMEE;

\item {} 
Odoo Consultant and Developer since 2012;

\item {} 
\sphinxhref{https://odoo-community.org/psc-teams/brazil-66}{PSC, team leader, of Brazilian Localization:}

\item {} 
Delegate member of Odoo Community Association;

\item {} 
Computer Engineer;

\item {} 
\sphinxhref{https://twitter.com/luisfelipemileo}{twitter @luisfelipemileo}

\item {} 
\sphinxhref{https://www.instagram.com/luisfelipemileo/}{instagram.com/luisfelipemileo}

\item {} 
\sphinxhref{https://linkedin.com/in/luisfelipemileo}{linkedin.com/in/luisfelipemileo}

\item {} 
\sphinxhref{https://github.com/mileo}{github.com/mileo}

\item {} 
www.kmee.com.br

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}\begin{itemize}
\item {} 
Fell free to contact me after the presentation at OCA discord channel. I will be glad to clarify any remaining doubts.

\end{itemize}
\end{sphinxadmonition}


\section{Agenda}
\label{\detokenize{technical:agenda}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Intro: Odoo + Odoo Community;

\item {} 
Setup Project: Odoo and Docker Environment;

\item {} 
Coding;

\item {} 
Q\&A session.

\end{enumerate}


\chapter{Intro: Odoo + Odoo Community}
\label{\detokenize{technical:intro-odoo-odoo-community}}

\section{The Odoo}
\label{\detokenize{technical:the-odoo}}
Odoo is an Open Source ERP + CRM:
\begin{itemize}
\item {} 
Great Framework to create Business APPs;

\item {} 
Uses Python + Javascript + PostgreSQL;

\item {} 
Source Code: \sphinxurl{https://github.com/odoo/odoo}

\item {} 
Technical Doc: \sphinxurl{https://www.odoo.com/documentation}

\item {} 
User Doc: \sphinxurl{https://www.odoo.com/documentation/user/}

\item {} 
User Training Videos: \sphinxurl{https://www.odoo.com/slides/all}

\item {} 
Great Community: OCA =D

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}\begin{itemize}
\item {} 
TIP: A good developer must seek functional understanding. If you know a module that has functionality similar to the one you want to develop, you can get good ideas by reading it.

\end{itemize}
\end{sphinxadmonition}


\section{The Odoo Community Association}
\label{\detokenize{technical:the-odoo-community-association}}
The Odoo Community Association, or OCA, is a nonprofit organization whose mission is to
promote the widespread use of Odoo and to support the collaborative development
of Odoo features.
\begin{itemize}
\item {} 
Website: \sphinxurl{https://odoo-community.org/}

\item {} 
Discord Channel: \sphinxurl{https://discord.gg/tNby4ku}

\item {} 
Mailing Lists: \sphinxurl{https://odoo-community.org/groups}

\end{itemize}
\begin{itemize}
\item {} \begin{description}
\item[{3000+ Odoo Modules with high quality code:}] \leavevmode\begin{itemize}
\item {} 
Search here: \sphinxurl{https://odoo-community.org/shop}

\item {} 
Find the code: \sphinxurl{https://github.com/oca}

\end{itemize}

\end{description}

\end{itemize}

\begin{sphinxadmonition}{warning}{Warning:}\begin{itemize}
\item {} 
OCA contributors use Twitter a lot! Find who they are here: \sphinxurl{https://github.com/orgs/OCA/people} and follow them.

\end{itemize}
\end{sphinxadmonition}


\section{Odoo + OCA:}
\label{\detokenize{technical:odoo-oca}}
\noindent{\hspace*{\fill}\sphinxincludegraphics{{eco}.png}\hspace*{\fill}}


\chapter{Docker environment}
\label{\detokenize{technical:docker-environment}}

\section{Docker environment}
\label{\detokenize{technical:id1}}
Although there are many ways to run Odoo, it’s important to know how to deploy it manually, because if you have a problem with docker, you will really need to know the basics.

If you don’t know it very well, check the Odoo doc:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{https}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{www}\PYG{o}{.}\PYG{n}{odoo}\PYG{o}{.}\PYG{n}{com}\PYG{o}{/}\PYG{n}{documentation}\PYG{o}{/}\PYG{l+m+mf}{14.0}\PYG{o}{/}\PYG{n}{setup}\PYG{o}{/}\PYG{n}{install}\PYG{o}{.}\PYG{n}{html}
\PYG{n}{https}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{www}\PYG{o}{.}\PYG{n}{odoo}\PYG{o}{.}\PYG{n}{com}\PYG{o}{/}\PYG{n}{documentation}\PYG{o}{/}\PYG{l+m+mf}{14.0}\PYG{o}{/}\PYG{n}{setup}\PYG{o}{/}\PYG{n}{deploy}\PYG{o}{.}\PYG{n}{html}
\end{sphinxVerbatim}

There are a lot of good docker implementations:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{http}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{github}\PYG{o}{.}\PYG{n}{com}\PYG{o}{/}\PYG{n}{odoo}\PYG{o}{/}\PYG{n}{docker}
\PYG{n}{https}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{github}\PYG{o}{.}\PYG{n}{com}\PYG{o}{/}\PYG{n}{acsone}\PYG{o}{/}\PYG{n}{odoo}\PYG{o}{\PYGZhy{}}\PYG{n}{bedrock}
\PYG{n}{https}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{github}\PYG{o}{.}\PYG{n}{com}\PYG{o}{/}\PYG{n}{Tecnativa}\PYG{o}{/}\PYG{n}{doodba}
\PYG{n}{https}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{github}\PYG{o}{.}\PYG{n}{com}\PYG{o}{/}\PYG{n}{camptocamp}\PYG{o}{/}\PYG{n}{docker}\PYG{o}{\PYGZhy{}}\PYG{n}{odoo}\PYG{o}{\PYGZhy{}}\PYG{n}{project}
\end{sphinxVerbatim}


\subsection{Camptocamp \sphinxhyphen{} Docker Odoo project}
\label{\detokenize{technical:camptocamp-docker-odoo-project}}
Main components:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxstylestrong{Docker project}: \sphinxurl{https://github.com/camptocamp/docker-odoo-project}

\item {} 
\sphinxstylestrong{Marabunta} (Used to provide an easy way to create Updates for Odoo fast and run easily): \sphinxurl{https://github.com/camptocamp/marabunta}

\item {} 
\sphinxstylestrong{Anthem} (Help scripting Odoo instances for automated setup, upgrades, testing and more): \sphinxurl{https://github.com/camptocamp/anthem}

\end{enumerate}


\subsection{Akretion \sphinxhyphen{} AK}
\label{\detokenize{technical:akretion-ak}}
The toolbelt for odoo: \sphinxurl{https://github.com/akretion/ak}

It does a lot of things, but in this training we will use it for only two:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Download the addons

\item {} 
Generate addons path

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Install with a normal user}
python3 \PYGZhy{}m pip install git+https://github.com/akretion/ak \PYGZhy{}\PYGZhy{}user
\end{sphinxVerbatim}


\section{Before start}
\label{\detokenize{technical:before-start}}
You will need to ensure a few things:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Docker installed and running: \sphinxurl{https://docs.docker.com/get-docker/}

\item {} 
Docker Compose: \sphinxurl{https://docs.docker.com/compose/install/}

\item {} 
Python 3

\item {} 
Python Pip \sphinxurl{https://pip.pypa.io/en/stable/installing/}

\item {} 
Install Akretion AK

\end{enumerate}


\section{Setup Odoo Environment}
\label{\detokenize{technical:setup-odoo-environment}}
We will start from a pre\sphinxhyphen{}configured repository. To know more about it you must study a
little about the camptocamp docker\sphinxhyphen{}odoo\sphinxhyphen{}project, docker itself and other used components
like postgresql and traefik.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
git clone https://github.com/kmee/oca\PYGZhy{}days\PYGZhy{}2020\PYGZhy{}odoo\PYGZhy{}developer.git \PYGZhy{}\PYGZhy{}branch\PYG{o}{=}template
\PYG{n+nb}{cd} oca\PYGZhy{}days\PYGZhy{}2020\PYGZhy{}odoo\PYGZhy{}developer\PYGZhy{}source
\end{sphinxVerbatim}

You will have the folder structure above:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{|}\PYGZhy{}\PYGZhy{} dev.docker\PYGZhy{}compose.yml
\PYG{p}{|}── docker\PYGZhy{}compose.yml
\PYG{p}{|}── odoo
    \PYG{p}{|}── data
    \PYG{p}{|}── dev\PYGZus{}oca\PYGZus{}days.egg\PYGZhy{}info
    \PYG{p}{|}── Dockerfile
    \PYG{p}{|}── external\PYGZhy{}src  \PYG{c+c1}{\PYGZsh{} Downloaded OCA repositories source code}
    \PYG{p}{|}── links
    \PYG{p}{|}── local\PYGZhy{}src   \PYG{c+c1}{\PYGZsh{} Your customer modules}
    \PYG{p}{|}── MANIFEST.in
    \PYG{p}{|}── migration.yml  \PYG{c+c1}{\PYGZsh{} Migration Scripts}
    \PYG{p}{|}── repo.yaml
    \PYG{p}{|}── requirements.txt  \PYG{c+c1}{\PYGZsh{} Extra requirements for your project}
    \PYG{p}{|}── setup.py
    \PYG{p}{|}── songs  \PYG{c+c1}{\PYGZsh{}  Scripts with antherm}
    \PYG{p}{|}── spec.yaml  \PYG{c+c1}{\PYGZsh{} Source Code specification: Where download Odoo and OCA repos.}
    \PYG{p}{|}── src  \PYG{c+c1}{\PYGZsh{} Downloaded Odoo Source Code}
    \PYG{p}{|}── VERSION
\end{sphinxVerbatim}


\subsection{Setup the project}
\label{\detokenize{technical:setup-the-project}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Inside de project go to Odoo folder}
\PYG{n+nb}{cd} training
\PYG{n+nb}{cd} odoo
\PYG{c+c1}{\PYGZsh{} Run **ak build** to download the sources}
ak build
\PYG{c+c1}{\PYGZsh{} To know more about what this command is doing read the file spec.yml}
\PYG{c+c1}{\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} Go back to the main folder}
\PYG{n+nb}{cd} ..
\PYG{c+c1}{\PYGZsh{} Build the Odoo Docker}
docker\PYGZhy{}compose build
\PYG{c+c1}{\PYGZsh{} To know more about what this command is doing read the file odoo/Dockerfile}
\end{sphinxVerbatim}


\section{Running Odoo}
\label{\detokenize{technical:running-odoo}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} In the project\PYGZsq{}s root folder}
docker\PYGZhy{}compose up
\PYG{c+c1}{\PYGZsh{} To stop press CTRL + C}
\end{sphinxVerbatim}

Check \sphinxurl{https://odoo.localhost}


\section{Adding OCA projects / modules}
\label{\detokenize{technical:adding-oca-projects-modules}}
Now that we have the Odoo up and running, let’s add a new project to improve it.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Go to \sphinxurl{https://odoo-community.org/shop} and search for \sphinxstylestrong{Responsive};

\item {} 
Open the module \sphinxstylestrong{web\_responsive}, from Tecnativa and LasLabs, go to the website(\sphinxurl{https://github.com/OCA/web})

\item {} 
Copy the link.

\item {} 
Edit spec.yml

\end{enumerate}

\begin{sphinxadmonition}{note}{Note:}
You can use Odoo SA shop to search modules too, but take a special attention in the author of the module.
\end{sphinxadmonition}

Editing spec.yml:

\fvset{hllines={, 5, 6, 7,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
odoo:
    modules: \PYG{o}{[}\PYG{o}{]}
    src: https://github.com/odoo/odoo \PYG{l+m}{13}.0

web:
    modules: \PYG{o}{[}\PYG{o}{]}
    src: https://github.com/OCA/web \PYG{l+m}{13}.0
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

When \sphinxstylestrong{ak build} has finished running it displays new addons path that you can must put in your docker\sphinxhyphen{}compose file

\fvset{hllines={, 4,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
ak build
\PYG{o}{[}...\PYG{o}{]}
\PYG{o}{(}INFO\PYG{o}{)} \PYG{o}{[}\PYG{l+m}{07}:21:45\PYG{o}{]} git\PYGZus{}aggregator.repo  src   End aggregation of /home/mileo/Projects/oca\PYGZhy{}days\PYGZhy{}2020/oca\PYGZhy{}days\PYGZhy{}2020\PYGZhy{}odoo\PYGZhy{}developer\PYGZhy{}source/odoo/src
Addons path \PYG{k}{for} your config file:  /odoo/links,/odoo/local\PYGZhy{}src,/odoo/src/odoo/addons,/odoo/src/addons,/odoo/external\PYGZhy{}src/web
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

TIP: This will add all the modules of the project OCA/web, if you just want the web\_responsive you can use the following syntax:

\fvset{hllines={, 6,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
odoo:
    modules: \PYG{o}{[}\PYG{o}{]}
    src: https://github.com/odoo/odoo \PYG{l+m}{13}.0

web:
    modules: \PYG{o}{[}\PYG{l+s+s1}{\PYGZsq{}web\PYGZus{}responsive\PYGZsq{}}\PYG{o}{]}
    src: https://github.com/OCA/web \PYG{l+m}{13}.0
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

Edit your docker compose to update the ADDONS\_PATH

\fvset{hllines={, 12,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
services:
  odoo:
    environment:
      \PYGZhy{} \PYG{n+nv}{PYTHONDONTWRITEBYTECODE}\PYG{o}{=}True
      \PYGZhy{} \PYG{n+nv}{LOCAL\PYGZus{}USER\PYGZus{}ID}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}UID}
      \PYG{o}{[}...\PYG{o}{]}
      \PYGZhy{} \PYG{n+nv}{DB\PYGZus{}PASS}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}PGPASSWORD}
      \PYGZhy{} \PYG{n+nv}{PGHOST}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}PGHOST}
      \PYGZhy{} \PYG{n+nv}{PGDATABASE}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}PGDATABASE}
      \PYGZhy{} \PYG{n+nv}{PGUSER}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}PGUSER}
      \PYGZhy{} \PYG{n+nv}{PGPASSWORD}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}PGPASSWORD}
      \PYGZhy{} \PYG{n+nv}{ADDONS\PYGZus{}PATH}\PYG{o}{=}/odoo/links,/odoo/local\PYGZhy{}src,/odoo/src/odoo/addons,/odoo/src/addons,/odoo/external\PYGZhy{}src/web
    hostname: \PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{ENV}\PYG{l+s+si}{\PYGZcb{}}\PYGZhy{}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{COMPOSE\PYGZus{}PROJECT\PYGZus{}NAME}\PYG{l+s+si}{\PYGZcb{}}
    labels:
      docky.main.service: \PYG{n+nb}{true}
      docky.user: odoo
    volumes:
      \PYGZhy{} ./odoo:/odoo
      \PYGZhy{} ./data/addons:/data/odoo/addons
      \PYG{o}{[}...\PYG{o}{]}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

To auto install web\_responsive with a migration script, edit you PROJECT\_ROOT/odoo/migration.yml

\fvset{hllines={, 12, 13, 14, 15,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
migration:
  options:
    install\PYGZus{}command: odoo
  versions:
    \PYGZhy{} version: \PYG{l+m}{13}.0.0.0.0
      \PYG{o}{[}...\PYG{o}{]}
      modes:
        demo:
          operations:
            post:
              \PYGZhy{} anthem songs.install.demo::main
    \PYGZhy{} version: \PYG{l+m}{13}.0.0.0.1
      addons:
        upgrade:
          \PYGZhy{} web\PYGZus{}responsive
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\chapter{Coding our first module}
\label{\detokenize{technical:coding-our-first-module}}

\section{Coding our first module}
\label{\detokenize{technical:id2}}
In our example module we will create an application for customer service management:
with Kanban and personalized workflow, integration with email and sms.

To help us we will use the \sphinxurl{https://github.com/acsone/bobtemplates.odoo} install it
in your local user:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip install bobtemplates.odoo
\end{sphinxVerbatim}


\subsection{Create your module skeletton}
\label{\detokenize{technical:create-your-module-skeletton}}
Run bob the command inside de folder local\sphinxhyphen{}src and answer the questions:

\fvset{hllines={, 2, 10, 11, 12, 13, 14, 15, 16, 17,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{cd} PROJECT\PYGZus{}ROOT/odoo/local\PYGZhy{}src
mrbob bobtemplates.odoo:addon

Welcome to mr.bob interactive mode. Before we generate directory structure,
some questions need to be answered.

Answer with a question mark to display help.
Values in square brackets at the end of the questions show the
default value \PYG{k}{if} there is no answer.

\PYGZhy{}\PYGZhy{}\PYGZgt{} Addon name \PYG{o}{(}with underscores\PYG{o}{)}: customer\PYGZus{}service
\PYGZhy{}\PYGZhy{}\PYGZgt{} Is it an OCA addon \PYG{o}{[}n\PYG{o}{]}:
\PYGZhy{}\PYGZhy{}\PYGZgt{} Summary: ACME Customer Service
\PYGZhy{}\PYGZhy{}\PYGZgt{} Version \PYG{o}{[}\PYG{l+m}{12}.0.1.0.0\PYG{o}{]}: \PYG{l+m}{13}.0.1.0.0
\PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright holder name: KMEE
\PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright year: \PYG{l+m}{2020}
\PYGZhy{}\PYGZhy{}\PYGZgt{} Website: www.kmee.com.br

Generated file structure at PROJECT\PYGZus{}ROOT/odoo/local\PYGZhy{}src
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

You will have the following file structure:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{|}── customer\PYGZus{}service
│   \PYG{p}{|}── \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}.py  \PYG{c+c1}{\PYGZsh{} All Odoo modules are python modules}
│   \PYG{p}{|}── \PYGZus{}\PYGZus{}manifest\PYGZus{}\PYGZus{}.py  \PYG{c+c1}{\PYGZsh{} Module manifest: Here you will have the name, dependencies, authors and etc}
\PYG{p}{|}── README.md  \PYG{c+c1}{\PYGZsh{} Description of the module, as displayed on github or OCA website.}
\end{sphinxVerbatim}

Add our module to the migration file, in a new version.

\fvset{hllines={, 4, 5, 6,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
    \PYG{o}{[}...\PYG{o}{]}
    \PYGZhy{} version: \PYG{l+m}{13}.0.0.0.1
      addons:
          \PYGZhy{} web\PYGZus{}responsive
    \PYGZhy{} version: \PYG{l+m}{13}.0.0.0.2
      addons:
          \PYGZhy{} customer\PYGZus{}service
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

Run Odoo an check that our module ir already installed.

TIP: When you are starting developing, the best way to go further is with little baby steps.

\begin{sphinxadmonition}{note}{Note:}\begin{description}
\item[{To learn more:}] \leavevmode\begin{itemize}
\item {} 
You can see a complete Odoo manifest here: \sphinxurl{https://github.com/OCA/maintainer-tools/blob/master/template/module/\_\_manifest\_\_.py}

\item {} 
The official documentation: \sphinxurl{https://www.odoo.com/documentation/14.0/reference/module.html}

\end{itemize}

\end{description}
\end{sphinxadmonition}


\subsection{Adding a new Business Model to our module}
\label{\detokenize{technical:adding-a-new-business-model-to-our-module}}
A model will represent the Business process, the data that you want to store and
behaviors of the data you’re storing.

The basics:
\begin{itemize}
\item {} 
Each model is a Python class that subclasses odoo.models.Model.

\item {} 
Each model is generally maps to a single database table.

\item {} 
Each attribute of the model represents a database field.

\item {} 
With all of this, Odoo gives you an automatically\sphinxhyphen{}generated database\sphinxhyphen{}access API; see Making queries.

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}\begin{description}
\item[{To learn more:}] \leavevmode\begin{itemize}
\item {} 
Check the Odoo documentation: \sphinxurl{https://www.odoo.com/documentation/14.0/reference/orm.html}

\item {} \begin{description}
\item[{Please read the Odoo code:}] \leavevmode\begin{itemize}
\item {} 
odoo/src/odoo/models.py

\item {} 
odoo/src/odoo/fields.py

\end{itemize}

\end{description}

\end{itemize}

\end{description}
\end{sphinxadmonition}

For example a CRM LEAD of Odoo Core crm module:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{Lead}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{crm.lead}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{\PYGZus{}description} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Lead/Opportunity}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{c+c1}{\PYGZsh{}[...]}
    \PYG{n}{name} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Opportunity}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{required}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{index}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
    \PYG{n}{partner\PYGZus{}id} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Many2one}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{res.partner}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{string}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Customer}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Linked partner (optional). Usually created when converting the lead. You can find a partner by its Name, TIN, Email or Internal Reference.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{active} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Boolean}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Active}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{default}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
    \PYG{n}{email\PYGZus{}from} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Email}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Email address of the contact}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{description} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Text}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Notes}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{}[...]}
\end{sphinxVerbatim}

With the help o bob.odoo we will create our first Odoo model with accompanying form, tree, action, menu, demo data and ACL

\fvset{hllines={, 2, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{cd} customer\PYGZus{}service \PYG{c+c1}{\PYGZsh{} Go inside de module folder that you want to create the model}
mrbob bobtemplates.odoo:model

Welcome to mr.bob interactive mode. Before we generate directory structure, some questions
need to be answered. Answer with a question mark to display help. Values in square
brackets at the end of the questions show the default value \PYG{k}{if} there is no answer.
\PYGZhy{}\PYGZhy{}\PYGZgt{} Odoo version \PYG{o}{(}\PYG{l+m}{8}\PYG{p}{|}\PYG{l+m}{9}\PYG{p}{|}\PYG{l+m}{10}\PYG{p}{|}\PYG{l+m}{11}\PYG{p}{|}\PYG{l+m}{12}\PYG{o}{)} \PYG{o}{[}\PYG{l+m}{12}\PYG{o}{]}: \PYG{l+m}{13}
\PYGZhy{}\PYGZhy{}\PYGZgt{} Model name \PYG{o}{(}dotted notation\PYG{o}{)}: customer.service.ticket
\PYGZhy{}\PYGZhy{}\PYGZgt{} Inherit \PYG{o}{[}y\PYG{o}{]}: n
\PYGZhy{}\PYGZhy{}\PYGZgt{} Form view \PYG{o}{[}y\PYG{o}{]}: y
\PYGZhy{}\PYGZhy{}\PYGZgt{} Search view \PYG{o}{[}y\PYG{o}{]}: y
\PYGZhy{}\PYGZhy{}\PYGZgt{} Tree view \PYG{o}{[}y\PYG{o}{]}: y
\PYGZhy{}\PYGZhy{}\PYGZgt{} Action and menu entry \PYG{o}{[}y\PYG{o}{]}: y
\PYGZhy{}\PYGZhy{}\PYGZgt{} ACL \PYG{o}{[}y\PYG{o}{]}: y
\PYGZhy{}\PYGZhy{}\PYGZgt{} Demo data \PYG{o}{[}y\PYG{o}{]}: y
\PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright holder name: KMEE
\PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright year: \PYG{l+m}{2020}
Generated file structure at PROJECT\PYGZus{}ROOT/odoo/local\PYGZhy{}src/customer\PYGZus{}service
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

You will have the following file structure:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{|}── customer\PYGZus{}service
│   \PYG{p}{|}── demo
│   │   \PYG{p}{|}── customer\PYGZus{}service\PYGZus{}ticket.xml
│   \PYG{p}{|}── \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}.py  \PYG{c+c1}{\PYGZsh{} Updated with the model import}
│   \PYG{p}{|}── \PYGZus{}\PYGZus{}manifest\PYGZus{}\PYGZus{}.py  \PYG{c+c1}{\PYGZsh{} Update with the imports of demo/security and views.}
│   \PYG{p}{|}── models
│   │   \PYG{p}{|}── customer\PYGZus{}service\PYGZus{}ticket.py \PYG{c+c1}{\PYGZsh{} Your module definition.}
│   │   \PYG{p}{|}── \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}.py
│   \PYG{p}{|}── security
│   │   \PYG{p}{|}── customer\PYGZus{}service\PYGZus{}ticket.xml \PYG{c+c1}{\PYGZsh{} User access rules}
│   \PYG{p}{|}── views
│       \PYG{p}{|}── customer\PYGZus{}service\PYGZus{}ticket.xml \PYG{c+c1}{\PYGZsh{} Our views: tree, form, search, kanban.}
\PYG{p}{|}── README.md
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}\begin{description}
\item[{To learn more:}] \leavevmode\begin{itemize}
\item {} 
You can see here a complete Odoo module: \sphinxurl{https://github.com/OCA/maintainer-tools/blob/master/template/module/}

\end{itemize}

\end{description}
\end{sphinxadmonition}

Before install it we need to fix some settings:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Create a main menu

\item {} 
Relate customer service menu with main menu

\item {} 
Ensure create / write / delete user access rules

\end{enumerate}

To create a main menu we need a icon, for that we will use a standard item, download from Odoo webiste:
\sphinxurl{https://www.odoo.com/pt\_BR/page/brand-assets}

Create the following folder structure inside the module and save it: \sphinxstylestrong{odoo/local\sphinxhyphen{}src/customer\_service/static/description/icon.png}

Inside de folder views, create a new file: \sphinxstylestrong{customer\_service/views/customer\_service\_menu.xml}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+cp}{\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{}?\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}odoo}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.menu\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}main\PYGZus{}menu\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}Customer Service\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}sequence\PYGZdq{}} \PYG{n+na}{eval=}\PYG{l+s}{\PYGZdq{}40\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}web\PYGZus{}icon\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer\PYGZus{}service,static/description/icon.png\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/odoo\PYGZgt{}}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}\begin{description}
\item[{To learn more:}] \leavevmode\begin{itemize}
\item {} 
Read more about the views at the official documentation: \sphinxurl{https://www.odoo.com/documentation/14.0/reference/views.html}

\end{itemize}

\end{description}
\end{sphinxadmonition}

Edit the module manifest to import the main menu:

\fvset{hllines={, 13,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Customer Service}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{description}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{        ACME Customer Service}\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{version}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{13.0.1.0.0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{license}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AGPL\PYGZhy{}3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{author}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{KMEE}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{website}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{www.kmee.com.br}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depends}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
    \PYG{p}{]}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{security/customer\PYGZus{}service\PYGZus{}ticket.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{views/customer\PYGZus{}service\PYGZus{}menu.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{views/customer\PYGZus{}service\PYGZus{}ticket.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{p}{]}\PYG{p}{,}
    \PYG{p}{[}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{]}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

Ensure that you put it before the customer\_service\_ticket, \sphinxstylestrong{the order matters}.

Let’s relate the service ticket menu with our new main menu, open the file: \sphinxstylestrong{odoo/local\sphinxhyphen{}src/customer\_service/views/customer\_service\_ticket.xml} and edit the last section:

\fvset{hllines={, 4,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
[...]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.menu\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}menu\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}Customer Service Ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}parent\PYGZus{}id\PYGZdq{}} \PYG{n+na}{ref=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}main\PYGZus{}menu\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}} \PYG{c}{\PYGZlt{}!\PYGZhy{}\PYGZhy{}}\PYG{c}{ The id of the main menu }\PYG{c}{\PYGZhy{}\PYGZhy{}\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}action\PYGZdq{}} \PYG{n+na}{ref=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}act\PYGZus{}window\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}sequence\PYGZdq{}} \PYG{n+na}{eval=}\PYG{l+s}{\PYGZdq{}16\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

\begin{sphinxadmonition}{note}{Note:}\begin{description}
\item[{To learn more:}] \leavevmode\begin{itemize}
\item {} 
You can see here a complete Odoo module: \sphinxurl{https://github.com/OCA/maintainer-tools/blob/master/template/module/}

\end{itemize}

\end{description}
\end{sphinxadmonition}

Edit
\sphinxstylestrong{odoo/local\sphinxhyphen{}src/customer\_service/security/customer\_service\_ticket.xml}
changing all the permissions to \sphinxstylestrong{ONE}

\fvset{hllines={, 9, 10, 11,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+cp}{\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{}?\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}odoo}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.model.access\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}access\PYGZus{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}} \PYG{c}{\PYGZlt{}!\PYGZhy{}\PYGZhy{}}\PYG{c}{ TODO acl id }\PYG{c}{\PYGZhy{}\PYGZhy{}\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket access name\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}} \PYG{c}{\PYGZlt{}!\PYGZhy{}\PYGZhy{}}\PYG{c}{ TODO acl name }\PYG{c}{\PYGZhy{}\PYGZhy{}\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZus{}id\PYGZdq{}} \PYG{n+na}{ref=}\PYG{l+s}{\PYGZdq{}model\PYGZus{}customer\PYGZus{}service\PYGZus{}ticket\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{c}{\PYGZlt{}!\PYGZhy{}\PYGZhy{}}\PYG{c}{ TODO review and adapt }\PYG{c}{\PYGZhy{}\PYGZhy{}\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}group\PYGZus{}id\PYGZdq{}} \PYG{n+na}{ref=}\PYG{l+s}{\PYGZdq{}base.group\PYGZus{}user\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}perm\PYGZus{}read\PYGZdq{}} \PYG{n+na}{eval=}\PYG{l+s}{\PYGZdq{}1\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}perm\PYGZus{}create\PYGZdq{}} \PYG{n+na}{eval=}\PYG{l+s}{\PYGZdq{}1\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}perm\PYGZus{}write\PYGZdq{}} \PYG{n+na}{eval=}\PYG{l+s}{\PYGZdq{}1\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}perm\PYGZus{}unlink\PYGZdq{}} \PYG{n+na}{eval=}\PYG{l+s}{\PYGZdq{}1\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/odoo\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\subsection{Updating your Odoo module manually}
\label{\detokenize{technical:updating-your-odoo-module-manually}}
If your docker\sphinxhyphen{}composed is already running, stop it. Run it with the folllowing parameters:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
docker\PYGZhy{}compose run \PYGZhy{}\PYGZhy{}rm \PYGZhy{}e \PYG{n+nv}{DB\PYGZus{}NAME}\PYG{o}{=}dev\PYGZhy{}oca\PYGZhy{}days odoo odoo \PYGZhy{}u customer\PYGZus{}service \PYGZhy{}\PYGZhy{}stop\PYGZhy{}after\PYGZhy{}init
\PYG{c+c1}{\PYGZsh{} This command will run Odoo, update the module customer\PYGZus{}service,}
\PYG{c+c1}{\PYGZsh{} installed on the database dev\PYGZhy{}oca\PYGZhy{}days and when finished will stop the Odoo.}
\PYG{c+c1}{\PYGZsh{} Start Odoo again as normally}
docker\PYGZhy{}compose up
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
The Odoo command line interface: \sphinxurl{https://www.odoo.com/documentation/14.0/reference/cmdline.html}
\end{sphinxadmonition}


\section{Adding fields to our model}
\label{\detokenize{technical:adding-fields-to-our-model}}
At this moment you must we have a basic module, that we can install, save and edit data. With a tree view and a form view.
But we need more, let’s edit \sphinxstyleemphasis{odoo/local\sphinxhyphen{}src/customer\_service/models/customer\_service\_ticket.py} and add some fields.

\fvset{hllines={, 9, 10, 11, 12,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{odoo} \PYG{k+kn}{import} \PYG{n}{api}\PYG{p}{,} \PYG{n}{fields}\PYG{p}{,} \PYG{n}{models}\PYG{p}{,} \PYG{n}{\PYGZus{}}

\PYG{k}{class} \PYG{n+nc}{CustomerServiceTicket}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{customer.service.ticket}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{\PYGZus{}description} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Customer Service Ticket}\PYG{l+s+s1}{\PYGZsq{}}  \PYG{c+c1}{\PYGZsh{} TODO}

    \PYG{n}{name} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{description} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Html}\PYG{p}{(}\PYG{n}{sanitize\PYGZus{}style}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
    \PYG{n}{user\PYGZus{}id} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Many2one}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{res.users}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{partner\PYGZus{}id} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Many2one}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{res.partner}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{partner\PYGZus{}email} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{n}{related}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{partner\PYGZus{}id.email}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

\begin{sphinxadmonition}{note}{Note:}\begin{itemize}
\item {} 
Check more about the Odoo fields: \sphinxurl{https://www.odoo.com/documentation/14.0/reference/orm.html\#fields}

\item {} 
odoo/src/odoo/fields.py \textless{}——\sphinxhyphen{} There is nothing better than reading the source code!!!!

\end{itemize}
\end{sphinxadmonition}

We need to add this new fields to the view, check your \sphinxstylestrong{odoo/local\sphinxhyphen{}src/customer\_service/views/customer\_service\_ticket.xml}, you will see
that are five blocks of code:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Form view;

\item {} 
Search / Filter View (Add Filter, Group and Favorites search);

\item {} 
Tree / List view;

\item {} 
Action (Speaking in a very simple way, links the menu with the views);

\item {} 
Menu;

\end{enumerate}

Add the all the new fields to the form view:

\fvset{hllines={, 11, 12, 13, 14,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.view\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}form\PYGZus{}view\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket.form (in customer\PYGZus{}service)\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}arch\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}xml\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}form}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}header}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/header\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}sheet}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}group}\PYG{n+nt}{\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}description\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}user\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}email\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}/group\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/sheet\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}div} \PYG{n+na}{class=}\PYG{l+s}{\PYGZdq{}oe\PYGZus{}chatter\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}\PYG{n+nt}{\PYGZlt{}/div\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}/form\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

Add the some fields to the tree view:

\fvset{hllines={, 7, 8,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.view\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}tree\PYGZus{}view\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket.tree (in customer\PYGZus{}service)\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}arch\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}xml\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}tree}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}user\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}/tree\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\section{Add a Kanban / Workflow}
\label{\detokenize{technical:add-a-kanban-workflow}}
To quick add a Kanban without coding a lot we will use a very nice OCA module: \sphinxstylestrong{base\_kanban\_stage}

In the moment of this talk the module isn’t migrated wet to version 13.0, then we will use a pull request instead of the main branch.
This is a good way to review other contributors work. Just be careful if you will gonna use it for production enviroment.

\sphinxurl{https://github.com/OCA/server-tools/pull/1799}

Lets add it to spec.yaml:

\fvset{hllines={, 7, 8, 9,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{odoo}\PYG{p}{:}
    \PYG{n+nt}{modules}\PYG{p}{:} \PYG{p+pIndicator}{[}\PYG{p+pIndicator}{]}
    \PYG{n+nt}{src}\PYG{p}{:} \PYG{l+lScalar+lScalarPlain}{https://github.com/odoo/odoo}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{13.0}

\PYG{n+nt}{web}\PYG{p}{:}
    \PYG{n+nt}{modules}\PYG{p}{:} \PYG{p+pIndicator}{[}\PYG{p+pIndicator}{]}
    \PYG{n+nt}{src}\PYG{p}{:} \PYG{l+lScalar+lScalarPlain}{https://github.com/OCA/web}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{13.0}

\PYG{n+nt}{kmee\PYGZhy{}server\PYGZhy{}tools}\PYG{p}{:}
    \PYG{n+nt}{modules}\PYG{p}{:} \PYG{p+pIndicator}{[}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{base\PYGZus{}kanban\PYGZus{}stage}\PYG{l+s}{\PYGZsq{}}\PYG{p+pIndicator}{]}
    \PYG{n+nt}{src}\PYG{p}{:} \PYG{l+lScalar+lScalarPlain}{https://github.com/kmee/server\PYGZhy{}tools}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{13.0\PYGZhy{}mig\PYGZhy{}base\PYGZus{}kanban\PYGZus{}stage}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\subsection{Add base\_kanban\_stage to our module dependencies}
\label{\detokenize{technical:add-base-kanban-stage-to-our-module-dependencies}}
The first step is to add base\_kanban\_stage to our module dependencies list. To do that we need to change the module manifest, by editing the \sphinxstylestrong{odoo/local\sphinxhyphen{}src/customer\_service/\_\_manifest\_\_.py}

\fvset{hllines={, 10,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Customer Service}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{description}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{        ACME Customer Service}\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{version}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{13.0.1.0.0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{license}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AGPL\PYGZhy{}3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{author}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{KMEE}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{website}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{www.kmee.com.br}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depends}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{base\PYGZus{}kanban\PYGZus{}stage}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{p}{]}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{security/customer\PYGZus{}service\PYGZus{}ticket.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{views/customer\PYGZus{}service\PYGZus{}menu.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{views/customer\PYGZus{}service\PYGZus{}ticket.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{p}{]}\PYG{p}{,}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\subsection{Inherit base.kanban.abstract in our model}
\label{\detokenize{technical:inherit-base-kanban-abstract-in-our-model}}\begin{description}
\item[{Inherit from \sphinxcode{\sphinxupquote{base.kanban.abstract}} to add Kanban stage functionality to}] \leavevmode
the customer.service.ticket:

\end{description}

\fvset{hllines={, 4,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{CustomerServiceTicket}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{customer.service.ticket}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{\PYGZus{}inherit} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{base.kanban.abstract}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

By doing that we add all the functionalists of the model ‘base.kanban.abstract’ in our model.

\begin{sphinxadmonition}{note}{Note:}\begin{description}
\item[{To learn more:}] \leavevmode\begin{itemize}
\item {} 
Odoo provides two inheritance mechanisms to extend an existing model in a modular way. \sphinxurl{https://www.odoo.com/documentation/14.0/howtos/backend.html?highlight=inherit\#inheritance}

\end{itemize}

\end{description}
\end{sphinxadmonition}

Add a new view record at \sphinxstylestrong{customer\_service\_ticket.xml} and the \sphinxstylestrong{kanban} to the view\_mode

\fvset{hllines={, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 16,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}kanban\PYGZus{}view\PYGZdq{}} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.view\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket.kanban (in customer\PYGZus{}service)\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}mode\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}primary\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}inherit\PYGZus{}id\PYGZdq{}} \PYG{n+na}{ref=}\PYG{l+s}{\PYGZdq{}base\PYGZus{}kanban\PYGZus{}stage.base\PYGZus{}kanban\PYGZus{}abstract\PYGZus{}view\PYGZus{}kanban\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}arch\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}xml\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}xpath} \PYG{n+na}{expr=}\PYG{l+s}{\PYGZdq{}//div[@name=\PYGZsq{}card\PYGZus{}body\PYGZsq{}]\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}/xpath\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}

\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.actions.act\PYGZus{}window\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}act\PYGZus{}window\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}Customer Service Ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}} \PYG{c}{\PYGZlt{}!\PYGZhy{}\PYGZhy{}}\PYG{c}{ TODO }\PYG{c}{\PYGZhy{}\PYGZhy{}\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}res\PYGZus{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}view\PYGZus{}mode\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}kanban,tree,form\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}domain\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}[]\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}context\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}\PYGZob{}\PYGZcb{}\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

We need to change the form view too, to add the field stage\_id to the header:

\fvset{hllines={, 7,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.view\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}form\PYGZus{}view\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket.form (in customer\PYGZus{}service)\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}arch\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}xml\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}form}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}header}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}stage\PYGZus{}id\PYGZdq{}} \PYG{n+na}{widget=}\PYG{l+s}{\PYGZdq{}statusbar\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/header\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}sheet}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}group}\PYG{n+nt}{\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}description\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}user\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}email\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}/group\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/sheet\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}div} \PYG{n+na}{class=}\PYG{l+s}{\PYGZdq{}oe\PYGZus{}chatter\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}\PYG{n+nt}{\PYGZlt{}/div\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}/form\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\section{Add Email features}
\label{\detokenize{technical:add-email-features}}
To add email features to our model, first we need to:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Add mail module to our module dependencies;

\item {} 
Add \sphinxstylestrong{mail.thread} to the inherit list of your model, same as we did with \sphinxstylestrong{base.kanban.abstract}

\item {} 
Improve the view to display the email fields;

\end{enumerate}

\begin{sphinxadmonition}{note}{Note:}\begin{description}
\item[{To learn more:}] \leavevmode\begin{itemize}
\item {} 
Odoo implements some useful classes and mixins that make it easy for you to add often\sphinxhyphen{}used behaviours on your objects. This guide will details most of them, with examples and use cases. \sphinxurl{https://www.odoo.com/documentation/14.0/reference/mixins.html?highlight=inherit}

\end{itemize}

\end{description}
\end{sphinxadmonition}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Add dependence:

\end{enumerate}

\fvset{hllines={, 11,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Customer Service}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{description}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{        ACME Customer Service}\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{version}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{13.0.1.0.0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{license}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AGPL\PYGZhy{}3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{author}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{KMEE}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{website}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{www.kmee.com.br}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depends}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{base\PYGZus{}kanban\PYGZus{}stage}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mail,}
    \PYG{p}{]}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{security/customer\PYGZus{}service\PYGZus{}ticket.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{views/customer\PYGZus{}service\PYGZus{}menu.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{views/customer\PYGZus{}service\PYGZus{}ticket.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{p}{]}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{demo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{demo/customer\PYGZus{}service\PYGZus{}ticket.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{p}{]}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{1}
\item {} 
Add \sphinxstylestrong{mail.thread} to the inherit list of your model:

\end{enumerate}

\fvset{hllines={, 4,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{CustomerServiceTicket}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{customer.service.ticket}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{\PYGZus{}inherit} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{base.kanban.abstract}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mail.thread}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
Improve the view;

\end{enumerate}

\fvset{hllines={, 19, 20,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.view\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}form\PYGZus{}view\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket.form (in customer\PYGZus{}service)\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}arch\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}xml\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}form}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}header}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}stage\PYGZus{}id\PYGZdq{}} \PYG{n+na}{widget=}\PYG{l+s}{\PYGZdq{}statusbar\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/header\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}sheet}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}group}\PYG{n+nt}{\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}description\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}user\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}email\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}/group\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/sheet\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}div} \PYG{n+na}{class=}\PYG{l+s}{\PYGZdq{}oe\PYGZus{}chatter\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}message\PYGZus{}follower\PYGZus{}ids\PYGZdq{}} \PYG{n+na}{widget=}\PYG{l+s}{\PYGZdq{}mail\PYGZus{}followers\PYGZdq{}} \PYG{n+na}{groups=}\PYG{l+s}{\PYGZdq{}base.group\PYGZus{}user\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}message\PYGZus{}ids\PYGZdq{}} \PYG{n+na}{widget=}\PYG{l+s}{\PYGZdq{}mail\PYGZus{}thread\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/div\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}/form\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\section{Sending SMS}
\label{\detokenize{technical:sending-sms}}
Odoo and Odoo SA has his own provider to send SMS, but we will override this behavior to
send SMS with the provider of our choice.

To do that we will create a new module called \sphinxstylestrong{sms\_nexmo} and we will propose it to OCA.

Here is an example of how to send SMS via nexmo:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{nexmo} \PYG{k+kn}{import} \PYG{n}{Client}
\PYG{k+kn}{from} \PYG{n+nn}{nexmo}\PYG{n+nn}{.}\PYG{n+nn}{sms} \PYG{k+kn}{import} \PYG{n}{Sms}

\PYG{n}{sms} \PYG{o}{=} \PYG{n}{Sms}\PYG{p}{(}\PYG{n}{Client}\PYG{p}{(}\PYG{n}{key}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{60e5d109}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{secret}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{************NMX}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{sms}\PYG{o}{.}\PYG{n}{send\PYGZus{}message}\PYG{p}{(}\PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{from}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Vonage APIs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{to}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{5535988763663}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{text}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Hello from Vonage SMS API}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\end{sphinxVerbatim}

Odoo SA has a module \sphinxstylestrong{sms} which has two methods that we need to override, here is the Odoo SA code:

\fvset{hllines={, 13, 18,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{SmsApi}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{AbstractModel}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sms.api}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{\PYGZus{}description} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SMS API}\PYG{l+s+s1}{\PYGZsq{}}

    \PYG{n+nd}{@api}\PYG{o}{.}\PYG{n}{model}
    \PYG{k}{def} \PYG{n+nf}{\PYGZus{}contact\PYGZus{}iap}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{local\PYGZus{}endpoint}\PYG{p}{,} \PYG{n}{params}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{account} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{env}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iap.account}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sms}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{n}{params}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{account\PYGZus{}token}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{account}\PYG{o}{.}\PYG{n}{account\PYGZus{}token}
        \PYG{n}{endpoint} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{env}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ir.config\PYGZus{}parameter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sudo}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{get\PYGZus{}param}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sms.endpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{DEFAULT\PYGZus{}ENDPOINT}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{iap}\PYG{o}{.}\PYG{n}{jsonrpc}\PYG{p}{(}\PYG{n}{endpoint} \PYG{o}{+} \PYG{n}{local\PYGZus{}endpoint}\PYG{p}{,} \PYG{n}{params}\PYG{o}{=}\PYG{n}{params}\PYG{p}{)}

    \PYG{n+nd}{@api}\PYG{o}{.}\PYG{n}{model}
    \PYG{k}{def} \PYG{n+nf}{\PYGZus{}send\PYGZus{}sms}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{numbers}\PYG{p}{,} \PYG{n}{message}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{params} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{numbers}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{numbers}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{message}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{message}\PYG{p}{\PYGZcb{}}
        \PYG{k}{return} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}contact\PYGZus{}iap}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/iap/message\PYGZus{}send}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{params}\PYG{p}{)}

    \PYG{n+nd}{@api}\PYG{o}{.}\PYG{n}{model}
    \PYG{k}{def} \PYG{n+nf}{\PYGZus{}send\PYGZus{}sms\PYGZus{}batch}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{messages}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{params} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{messages}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{messages}\PYG{p}{\PYGZcb{}}
        \PYG{k}{return} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}contact\PYGZus{}iap}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/iap/sms/1/send}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{params}\PYG{p}{)}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\section{Creating a module to be sent to OCA}
\label{\detokenize{technical:creating-a-module-to-be-sent-to-oca}}
This time we will not create the module \sphinxstylestrong{sms\_nexmo} at local\sphinxhyphen{}src folder.
We will create and send a pull request at OCA project: \sphinxurl{https://github.com/OCA/connector-telephony}

But to To do that, we need to ensure a feel things:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
A fork of this project.

\item {} 
Add our fork to spec.yml

\item {} 
Start coding

\item {} 
Make a pull request

\end{enumerate}


\subsection{Adding a Fork to our project}
\label{\detokenize{technical:adding-a-fork-to-our-project}}
Go to the project, find the fork button on the upper right side of the screen.
Fork it to your user/organization, and add your remote fork url to spec.yml

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{odoo}\PYG{p}{:}
    \PYG{n+nt}{modules}\PYG{p}{:} \PYG{p+pIndicator}{[}\PYG{p+pIndicator}{]}
    \PYG{n+nt}{src}\PYG{p}{:} \PYG{l+lScalar+lScalarPlain}{https://github.com/odoo/odoo}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{13.0}

\PYG{n+nt}{web}\PYG{p}{:}
    \PYG{n+nt}{modules}\PYG{p}{:} \PYG{p+pIndicator}{[}\PYG{p+pIndicator}{]}
    \PYG{n+nt}{src}\PYG{p}{:} \PYG{l+lScalar+lScalarPlain}{https://github.com/OCA/web}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{13.0}

\PYG{n+nt}{kmee\PYGZhy{}server\PYGZhy{}tools}\PYG{p}{:}
    \PYG{n+nt}{modules}\PYG{p}{:} \PYG{p+pIndicator}{[}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{base\PYGZus{}kanban\PYGZus{}stage}\PYG{l+s}{\PYGZsq{}}\PYG{p+pIndicator}{]}
    \PYG{n+nt}{src}\PYG{p}{:} \PYG{l+lScalar+lScalarPlain}{https://github.com/kmee/server\PYGZhy{}tools}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{13.0\PYGZhy{}mig\PYGZhy{}base\PYGZus{}kanban\PYGZus{}stage}

\PYG{n+nt}{connector\PYGZhy{}telephony}\PYG{p}{:}
    \PYG{n+nt}{modules}\PYG{p}{:} \PYG{p+pIndicator}{[}\PYG{p+pIndicator}{]}
    \PYG{n+nt}{src}\PYG{p}{:} \PYG{l+lScalar+lScalarPlain}{https://github.com/YOUR\PYGZus{}REMOTE\PYGZus{}HERE/connector\PYGZhy{}telephony}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{13.0}
\end{sphinxVerbatim}

Run \sphinxstylestrong{ak build} and update the \sphinxstylestrong{addons path}


\subsection{Easy creating a OCA module with bobtemplates.odoo}
\label{\detokenize{technical:easy-creating-a-oca-module-with-bobtemplates-odoo}}
\fvset{hllines={, 2, 10, 11, 12, 13, 14, 15, 16, 17,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{cd} PROJECT\PYGZus{}ROOT/odoo/external\PYGZhy{}src/connector\PYGZhy{}telephony
mrbob bobtemplates.odoo:addon

Welcome to mr.bob interactive mode. Before we generate directory structure,
some questions need to be answered.

Answer with a question mark to display help.
Values in square brackets at the end of the questions show the
default value \PYG{k}{if} there is no answer.

\PYGZhy{}\PYGZhy{}\PYGZgt{} Addon name \PYG{o}{(}with underscores\PYG{o}{)}: sms\PYGZus{}nexmo
\PYGZhy{}\PYGZhy{}\PYGZgt{} Is it an OCA addon \PYG{o}{[}n\PYG{o}{]}: Y
\PYGZhy{}\PYGZhy{}\PYGZgt{} Summary: Send SMS with Nexmo instead of Odoo SA IAP.
\PYGZhy{}\PYGZhy{}\PYGZgt{} Version \PYG{o}{[}\PYG{l+m}{12}.0.1.0.0\PYG{o}{]}: \PYG{l+m}{13}.0.1.0.0
\PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright holder name: KMEE
\PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright year: \PYG{l+m}{2020}
\PYGZhy{}\PYGZhy{}\PYGZgt{} Website: https://github.com/OCA/connector\PYGZhy{}telephony
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

You module sms\_nexmo must depend of Odoo SA sms module:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sms Nexmo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{summary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{        Send SMS with Nexmo instead of Odoo SA IAP.}\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{version}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{13.0.1.0.0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{license}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AGPL\PYGZhy{}3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{author}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{KMEE,Odoo Community Association (OCA)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{website}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{https://github.com/OCA/connector\PYGZhy{}telephony}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depends}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sms}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{p}{]}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{views/iap\PYGZus{}account.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
    \PYG{p}{]}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{demo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
    \PYG{p}{]}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsection{Extending Odoo models}
\label{\detokenize{technical:extending-odoo-models}}
We will need to change the behavior of two Odoo models:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxstylestrong{iap.account}: To save the nexmo key and secret;

\item {} 
\sphinxstylestrong{sms.api}: To overwrite the methods: \_send\_sms and \_send\_sms\_batch

\end{enumerate}


\subsection{Extending Odoo models: iap.account}
\label{\detokenize{technical:extending-odoo-models-iap-account}}
We need to create two new fields at the model iap.account and add it to the form screen.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{cd} PROJECT\PYGZus{}ROOT/odoo/external\PYGZhy{}src/connector\PYGZhy{}telephony/sms\PYGZus{}nexmo
mrbob bobtemplates.odoo:model

Welcome to mr.bob interactive mode. Before we generate directory structure,
some questions need to be answered. Answer with a question mark to display help.
Values in square brackets at the end of the questions show the
default value \PYG{k}{if} there is no answer.

    \PYGZhy{}\PYGZhy{}\PYGZgt{} Odoo version \PYG{o}{(}\PYG{l+m}{8}\PYG{p}{|}\PYG{l+m}{9}\PYG{p}{|}\PYG{l+m}{10}\PYG{p}{|}\PYG{l+m}{11}\PYG{p}{|}\PYG{l+m}{12}\PYG{o}{)} \PYG{o}{[}\PYG{l+m}{12}\PYG{o}{]}: \PYG{l+m}{13}
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Model name \PYG{o}{(}dotted notation\PYG{o}{)}: iap.account
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Inherit \PYG{o}{[}y\PYG{o}{]}: Y
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Form view \PYG{o}{[}y\PYG{o}{]}: Y
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Search view \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Tree view \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Action and menu entry \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} ACL \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Demo data \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright holder name: KMEE
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright year: \PYG{l+m}{2020}
\end{sphinxVerbatim}

Adding the two fields to the model is very easy, edit the file: \sphinxstylestrong{PROJECT\_ROOT/odoo/external\sphinxhyphen{}src/connector\sphinxhyphen{}telephony/sms\_nexmo/models/iap\_account.py}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{odoo} \PYG{k+kn}{import} \PYG{n}{api}\PYG{p}{,} \PYG{n}{fields}\PYG{p}{,} \PYG{n}{models}\PYG{p}{,} \PYG{n}{\PYGZus{}}

\PYG{k}{class} \PYG{n+nc}{IapAccount}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{\PYGZus{}inherit} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iap.account}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{key} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{secret} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

To add them to form view, the easy way is to find the view and at developer mode click on View Form View to discover the external id of the main view.

Only with the external id in hand can we edit the inherited view.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.view\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}iap\PYGZus{}account\PYGZus{}form\PYGZus{}view\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}iap.account.form (in sms\PYGZus{}nexmo)\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}iap.account\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}inherit\PYGZus{}id\PYGZdq{}} \PYG{n+na}{ref=}\PYG{l+s}{\PYGZdq{}iap.iap\PYGZus{}account\PYGZus{}view\PYGZus{}form\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}arch\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}xml\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}account\PYGZus{}token\PYGZdq{}} \PYG{n+na}{position=}\PYG{l+s}{\PYGZdq{}after\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}key\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}secret\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}\begin{itemize}
\item {} 
TIP: Always remember to use the complete name: \textless{}MODULE\textgreater{}\textless{}DOT\textgreater{}\textless{}RECORD\_ID\textgreater{}

\item {} 
Check the documentation about the view inheritance: \sphinxurl{https://www.odoo.com/documentation/14.0/reference/views.html?highlight=inherit\#inheritance}

\end{itemize}
\end{sphinxadmonition}


\subsection{Overwriting Odoo model: sms.api}
\label{\detokenize{technical:overwriting-odoo-model-sms-api}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{cd} PROJECT\PYGZus{}ROOT/odoo/external\PYGZhy{}src/connector\PYGZhy{}telephony/sms\PYGZus{}nexmo
mrbob bobtemplates.odoo:model

Welcome to mr.bob interactive mode. Before we generate directory structure,
some questions need to be answered. Answer with a question mark to display help.
Values in square brackets at the end of the questions show the
default value \PYG{k}{if} there is no answer.

    \PYGZhy{}\PYGZhy{}\PYGZgt{} Odoo version \PYG{o}{(}\PYG{l+m}{8}\PYG{p}{|}\PYG{l+m}{9}\PYG{p}{|}\PYG{l+m}{10}\PYG{p}{|}\PYG{l+m}{11}\PYG{p}{|}\PYG{l+m}{12}\PYG{o}{)} \PYG{o}{[}\PYG{l+m}{12}\PYG{o}{]}: \PYG{l+m}{13}
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Model name \PYG{o}{(}dotted notation\PYG{o}{)}: sms.api
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Inherit \PYG{o}{[}y\PYG{o}{]}: Y
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Form view \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Search view \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Tree view \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Action and menu entry \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} ACL \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Demo data \PYG{o}{[}y\PYG{o}{]}: n
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright holder name: KMEE
    \PYGZhy{}\PYGZhy{}\PYGZgt{} Copyright year: \PYG{l+m}{2020}
\end{sphinxVerbatim}

To send sms we will need an external library: \sphinxurl{https://pypi.org/project/nexmo/}

We must also not forget to add it to requirements.txt and run the build command again.

odoo/requirements.txt

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nv}{nexmo}\PYG{o}{=}\PYG{o}{=}\PYG{l+m}{2}.5.2
\end{sphinxVerbatim}

And from the PROJECT\_ROOT

\begin{sphinxVerbatim}[commandchars=\\\{\}]
docker\PYGZhy{}compose build
\end{sphinxVerbatim}

Now we can use it on our python class:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{odoo} \PYG{k+kn}{import} \PYG{n}{api}\PYG{p}{,} \PYG{n}{fields}\PYG{p}{,} \PYG{n}{models}\PYG{p}{,} \PYG{n}{\PYGZus{}}
\PYG{k+kn}{from} \PYG{n+nn}{nexmo} \PYG{k+kn}{import} \PYG{n}{Client}
\PYG{k+kn}{from} \PYG{n+nn}{nexmo}\PYG{n+nn}{.}\PYG{n+nn}{sms} \PYG{k+kn}{import} \PYG{n}{Sms}

\PYG{k}{class} \PYG{n+nc}{SmsApi}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{AbstractModel}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{\PYGZus{}inherit} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sms.api}\PYG{l+s+s1}{\PYGZsq{}}

    \PYG{k}{def} \PYG{n+nf}{\PYGZus{}send\PYGZus{}sms\PYGZus{}nexmo}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{sms}\PYG{p}{,} \PYG{n}{params}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{sms}\PYG{o}{.}\PYG{n}{send\PYGZus{}message}\PYG{p}{(}\PYG{n}{params}\PYG{p}{)}

    \PYG{n+nd}{@api}\PYG{o}{.}\PYG{n}{model}
    \PYG{k}{def} \PYG{n+nf}{\PYGZus{}send\PYGZus{}sms}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{numbers}\PYG{p}{,} \PYG{n}{message}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{account} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{env}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iap.account}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nexmo.sms}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{account}\PYG{p}{:}
            \PYG{k}{return} \PYG{n+nb}{super}\PYG{p}{(}\PYG{n}{SmsApi}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{o}{.}\PYG{n}{\PYGZus{}send\PYGZus{}sms}\PYG{p}{(}\PYG{n}{numbers}\PYG{p}{,} \PYG{n}{message}\PYG{p}{)}

        \PYG{n}{sms} \PYG{o}{=} \PYG{n}{Sms}\PYG{p}{(}\PYG{n}{Client}\PYG{p}{(}\PYG{n}{key}\PYG{o}{=}\PYG{n}{account}\PYG{o}{.}\PYG{n}{key}\PYG{p}{,} \PYG{n}{secret}\PYG{o}{=}\PYG{n}{account}\PYG{o}{.}\PYG{n}{secret}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}send\PYGZus{}sms\PYGZus{}nexmo}\PYG{p}{(}\PYG{n}{sms}\PYG{p}{,} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{from}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Odoo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{to}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{numbers}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{text}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{message}\PYG{p}{,}
        \PYG{p}{\PYGZcb{}}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nd}{@api}\PYG{o}{.}\PYG{n}{model}
\PYG{k}{def} \PYG{n+nf}{\PYGZus{}send\PYGZus{}sms\PYGZus{}batch}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{messages}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{account} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{env}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iap.account}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nexmo.sms}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{account}\PYG{p}{:}
        \PYG{k}{return} \PYG{n+nb}{super}\PYG{p}{(}\PYG{n}{SmsApi}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{o}{.}\PYG{n}{\PYGZus{}send\PYGZus{}sms\PYGZus{}batch}\PYG{p}{(}\PYG{n}{messages}\PYG{p}{)}

    \PYG{n}{sms} \PYG{o}{=} \PYG{n}{Sms}\PYG{p}{(}\PYG{n}{Client}\PYG{p}{(}\PYG{n}{key}\PYG{o}{=}\PYG{n}{account}\PYG{o}{.}\PYG{n}{key}\PYG{p}{,} \PYG{n}{secret}\PYG{o}{=}\PYG{n}{account}\PYG{o}{.}\PYG{n}{secret}\PYG{p}{)}\PYG{p}{)}

    \PYG{k}{for} \PYG{n}{record} \PYG{o+ow}{in} \PYG{n}{messages}\PYG{p}{:}
        \PYG{n}{result} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}send\PYGZus{}sms\PYGZus{}nexmo}\PYG{p}{(}\PYG{n}{sms}\PYG{p}{,} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{from}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Odoo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{to}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{record}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{number}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{text}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{record}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{content}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
        \PYG{p}{\PYGZcb{}}\PYG{p}{)}
        \PYG{k}{if} \PYG{n}{result}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{messages}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
            \PYG{n}{record}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{state}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{success}\PYG{l+s+s1}{\PYGZsq{}}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{record}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{state}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{k}{return} \PYG{n}{messages}
\end{sphinxVerbatim}


\section{Integrate Customer Service with SMS}
\label{\detokenize{technical:integrate-customer-service-with-sms}}
Before getting your hands dirty and integrating our module with sms it is important that you understand some things.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
When we changed the definition of our model so that it inherited from mail.thread. We made him acquire all the functionality of the email module.

\end{enumerate}

\fvset{hllines={, 4,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{CustomerServiceTicket}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{customer.service.ticket}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{\PYGZus{}inherit} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{base.kanban.abstract}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mail.thread}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{1}
\item {} 
When installing the Odoo SA \sphinxstylestrong{sms} module we added new features to the mail.thread model, making Odoo records able to communicate via sms as well.

\item {} 
When we create a module sms\_nexmo we change de default behavior of sending sms via Odoo SA IAP to send it via Nexmo.

\end{enumerate}


\subsection{Send customer service number by SMS}
\label{\detokenize{technical:send-customer-service-number-by-sms}}
We will create a button to allow user to send ticket number to the partner by sms. But before that we will need the ticket number.

Lets add a sequence to our model, by creating:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Folder data at \sphinxstylestrong{PROJECT\_ROOT/odoo/local\sphinxhyphen{}src/customer\_service/data}

\item {} 
A file: \sphinxstylestrong{PROJECT\_ROOT/odoo/local\sphinxhyphen{}src/customer\_service/data/ir\_sequence\_data.xml}

\end{enumerate}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
Add it to the module manifest.

\end{enumerate}

\fvset{hllines={, 4,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+cp}{\PYGZlt{}?xml version=\PYGZdq{}1.0\PYGZdq{} encoding=\PYGZdq{}utf\PYGZhy{}8\PYGZdq{}?\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}odoo}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}data} \PYG{n+na}{noupdate=}\PYG{l+s}{\PYGZdq{}1\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}

        \PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}sequence\PYGZdq{}} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.sequence\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}CustomerService\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}code\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}prefix\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}CS/\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}padding\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}7\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}

    \PYG{n+nt}{\PYGZlt{}/data\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/odoo\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

Auto create a sequence when creating a new record:

\fvset{hllines={, 10,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{odoo} \PYG{k+kn}{import} \PYG{n}{api}\PYG{p}{,} \PYG{n}{fields}\PYG{p}{,} \PYG{n}{models}\PYG{p}{,} \PYG{n}{\PYGZus{}}

\PYG{k}{class} \PYG{n+nc}{CustomerServiceTicket}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{customer.service.ticket}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{\PYGZus{}inherit} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{base.kanban.abstract}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mail.thread}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

    \PYG{n}{\PYGZus{}description} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Customer Service Ticket}\PYG{l+s+s1}{\PYGZsq{}}  \PYG{c+c1}{\PYGZsh{} TODO}

    \PYG{n}{code} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}
        \PYG{n}{readonly}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}
        \PYG{n}{default}\PYG{o}{=}\PYG{k}{lambda} \PYG{n+nb+bp}{self}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{env}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ir.sequence}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{next\PYGZus{}by\PYGZus{}code}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{customer.service}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{p}{)}
    \PYG{n}{name} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{description} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Html}\PYG{p}{(}\PYG{n}{sanitize\PYGZus{}style}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
    \PYG{n}{user\PYGZus{}id} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Many2one}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{res.users}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{partner\PYGZus{}id} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Many2one}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{res.partner}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{partner\PYGZus{}email} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{n}{related}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{partner\PYGZus{}id.email}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

Add the new field to the form view:

\fvset{hllines={, 11,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.view\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}form\PYGZus{}view\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket.form (in customer\PYGZus{}service)\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}arch\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}xml\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}form}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}header}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}stage\PYGZus{}id\PYGZdq{}} \PYG{n+na}{widget=}\PYG{l+s}{\PYGZdq{}statusbar\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/header\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}sheet}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}group}\PYG{n+nt}{\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}code\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}description\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}user\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}email\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}/group\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/sheet\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}div} \PYG{n+na}{class=}\PYG{l+s}{\PYGZdq{}oe\PYGZus{}chatter\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}message\PYGZus{}follower\PYGZus{}ids\PYGZdq{}} \PYG{n+na}{widget=}\PYG{l+s}{\PYGZdq{}mail\PYGZus{}followers\PYGZdq{}} \PYG{n+na}{groups=}\PYG{l+s}{\PYGZdq{}base.group\PYGZus{}user\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}message\PYGZus{}ids\PYGZdq{}} \PYG{n+na}{widget=}\PYG{l+s}{\PYGZdq{}mail\PYGZus{}thread\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/div\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

Add the new field to the tree view:

\fvset{hllines={, 6,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.view\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}tree\PYGZus{}view\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket.tree (in customer\PYGZus{}service)\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}arch\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}xml\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}tree}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}code\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}user\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}/tree\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
\PYG{n+nt}{\PYGZlt{}/record\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\subsection{Creating a button to send sms}
\label{\detokenize{technical:creating-a-button-to-send-sms}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Add the button to the view

\item {} 
Create the method at the model

\end{enumerate}

\fvset{hllines={, 8,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nt}{\PYGZlt{}record} \PYG{n+na}{model=}\PYG{l+s}{\PYGZdq{}ir.ui.view\PYGZdq{}} \PYG{n+na}{id=}\PYG{l+s}{\PYGZdq{}customer\PYGZus{}service\PYGZus{}ticket\PYGZus{}form\PYGZus{}view\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket.form (in customer\PYGZus{}service)\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}model\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}customer.service.ticket\PYG{n+nt}{\PYGZlt{}/field\PYGZgt{}}
    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}arch\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}xml\PYGZdq{}}\PYG{n+nt}{\PYGZgt{}}
        \PYG{n+nt}{\PYGZlt{}form}\PYG{n+nt}{\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}header}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}stage\PYGZus{}id\PYGZdq{}} \PYG{n+na}{widget=}\PYG{l+s}{\PYGZdq{}statusbar\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}button} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}send\PYGZus{}number\PYGZus{}by\PYGZus{}sms\PYGZdq{}} \PYG{n+na}{type=}\PYG{l+s}{\PYGZdq{}object\PYGZdq{}} \PYG{n+na}{string=}\PYG{l+s}{\PYGZdq{}Send Object by SMS\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}/header\PYGZgt{}}
            \PYG{n+nt}{\PYGZlt{}sheet}\PYG{n+nt}{\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}group}\PYG{n+nt}{\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}code\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}name\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}description\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}user\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}id\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                    \PYG{n+nt}{\PYGZlt{}field} \PYG{n+na}{name=}\PYG{l+s}{\PYGZdq{}partner\PYGZus{}email\PYGZdq{}}\PYG{n+nt}{/\PYGZgt{}}
                \PYG{n+nt}{\PYGZlt{}/group\PYGZgt{}}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines

\fvset{hllines={, 10, 11, 12, 13,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{odoo} \PYG{k+kn}{import} \PYG{n}{api}\PYG{p}{,} \PYG{n}{fields}\PYG{p}{,} \PYG{n}{models}\PYG{p}{,} \PYG{n}{\PYGZus{}}

\PYG{k}{class} \PYG{n+nc}{CustomerServiceTicket}\PYG{p}{(}\PYG{n}{models}\PYG{o}{.}\PYG{n}{Model}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{customer.service.ticket}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{\PYGZus{}inherit} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{base.kanban.abstract}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mail.thread}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

    \PYG{n}{\PYGZus{}description} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Customer Service Ticket}\PYG{l+s+s1}{\PYGZsq{}}  \PYG{c+c1}{\PYGZsh{} TODO}

    \PYG{n}{code} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}
        \PYG{n}{readonly}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}
        \PYG{n}{default}\PYG{o}{=}\PYG{k}{lambda} \PYG{n+nb+bp}{self}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{env}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ir.sequence}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{next\PYGZus{}by\PYGZus{}code}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{customer.service}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{p}{)}
    \PYG{n}{name} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{description} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Html}\PYG{p}{(}\PYG{n}{sanitize\PYGZus{}style}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
    \PYG{n}{user\PYGZus{}id} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Many2one}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{res.users}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{partner\PYGZus{}id} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Many2one}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{res.partner}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{partner\PYGZus{}email} \PYG{o}{=} \PYG{n}{fields}\PYG{o}{.}\PYG{n}{Char}\PYG{p}{(}\PYG{n}{related}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{partner\PYGZus{}id.email}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{k}{def} \PYG{n+nf}{send\PYGZus{}number\PYGZus{}by\PYGZus{}sms}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{record} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{p}{:}
            \PYG{n}{record}\PYG{o}{.}\PYG{n}{\PYGZus{}message\PYGZus{}sms}\PYG{p}{(}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{OCA days: Your ticket number is }\PYG{l+s+si}{\PYGZob{}\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{n}{record}\PYG{o}{.}\PYG{n}{code}\PYG{p}{)}\PYG{p}{,}
                \PYG{n}{partner\PYGZus{}ids}\PYG{o}{=}\PYG{n}{record}\PYG{o}{.}\PYG{n}{partner\PYGZus{}id}\PYG{o}{.}\PYG{n}{ids}
            \PYG{p}{)}
\end{sphinxVerbatim}
\sphinxresetverbatimhllines


\section{Seding your module to the OCA}
\label{\detokenize{technical:seding-your-module-to-the-oca}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Commit

\item {} 
Push to the fork

\item {} 
Create a pull request

\end{enumerate}

\begin{sphinxadmonition}{note}{Note:}\begin{description}
\item[{To learn more:}] \leavevmode\begin{itemize}
\item {} 
Check the OCA guidelines: \sphinxurl{https://github.com/OCA/odoo-community.org/blob/master/website/Contribution/CONTRIBUTING.rst}

\end{itemize}

\end{description}
\end{sphinxadmonition}


\section{Review}
\label{\detokenize{technical:review}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Setup your project from a project template;

\item {} 
Use OCA modules;

\item {} 
Create your own module;

\item {} 
Create an OCA module;

\end{enumerate}


\chapter{Questions and answers}
\label{\detokenize{technical:questions-and-answers}}

\section{Thank you to the OCA Sponsors}
\label{\detokenize{technical:thank-you-to-the-oca-sponsors}}
\noindent{\hspace*{\fill}\sphinxincludegraphics[width=550\sphinxpxdimen,height=500\sphinxpxdimen]{{sponsors}.jpg}\hspace*{\fill}}


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{Index}
\printindex
\end{document}