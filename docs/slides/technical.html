<!DOCTYPE html>


<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Odoo Developer Training &mdash; 945 Manuals 2020.10.21 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/styles.css" type="text/css" />
    <link rel="stylesheet" href="_static/single.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <link rel="stylesheet" href="_static/odoo.css" type="text/css" />
    
    
    
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2020.10.21',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/common.js"></script>
    
    <script type="text/javascript" src="_static/slides.js"></script>
    <script type="text/javascript" src="_static/sync.js"></script>
    <script type="text/javascript" src="_static/controller.js"></script>
    <script type="text/javascript" src="_static/init.js"></script>
    
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="945 Manuals 2020.10.21 documentation" href="index.html" />
    <link rel="prev" title="945 APIs" href="api.html" /> 
  </head>
  <body>

<section
   id="slide_container"
   class='slides layout-regular'>


  
<article class="slide level-1" id="odoo-developer-training">

<h1>Odoo Developer Training</h1>

<p>From Basis to First Module</p>




</article>
<article class="slide level-2" id="oca-days-2020">

<h2>OCA Days - 2020</h2>

<img alt="_images/oca-days-logo.png" class="align-center" src="_images/oca-days-logo.png" />




</article>
<article class="slide level-2" id="luis-felipe-mileo">

<h2>Luis Felipe Miléo</h2>

<ul class="simple">
<li>Co-founder and CEO at KMEE;</li>
<li>Odoo Consultant and Developer since 2012;</li>
<li><a class="reference external" href="https://odoo-community.org/psc-teams/brazil-66">PSC, team leader, of Brazilian Localization:</a></li>
<li>Delegate member of Odoo Community Association;</li>
<li>Computer Engineer;</li>
<li><a class="reference external" href="https://twitter.com/luisfelipemileo">twitter &#64;luisfelipemileo</a></li>
<li><a class="reference external" href="https://www.instagram.com/luisfelipemileo/">instagram.com/luisfelipemileo</a></li>
<li><a class="reference external" href="https://linkedin.com/in/luisfelipemileo">linkedin.com/in/luisfelipemileo</a></li>
<li><a class="reference external" href="https://github.com/mileo">github.com/mileo</a></li>
<li>www.kmee.com.br</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Fell free to contact me after the presentation at OCA discord channel. I will be glad to clarify any remaining doubts.</li>
</ul>
</div>




</article>
<article class="slide level-2" id="agenda">

<h2>Agenda</h2>

<ol class="arabic simple">
<li>Intro: Odoo + Odoo Community;</li>
<li>Setup Project: Odoo and Docker Environment;</li>
<li>Coding;</li>
<li>Q&amp;A session.</li>
</ol>




</article>
<article class="slide level-1" id="intro-odoo-odoo-community">

<h1>Intro: Odoo + Odoo Community</h1>





</article>
<article class="slide level-2" id="the-odoo">

<h2>The Odoo</h2>

<p>Odoo is an Open Source ERP + CRM:</p>
<ul class="simple">
<li>Great Framework to create Business APPs;</li>
<li>Uses Python + Javascript + PostgreSQL;</li>
<li>Source Code: <a class="reference external" href="https://github.com/odoo/odoo">https://github.com/odoo/odoo</a></li>
<li>Technical Doc: <a class="reference external" href="https://www.odoo.com/documentation">https://www.odoo.com/documentation</a></li>
<li>User Doc: <a class="reference external" href="https://www.odoo.com/documentation/user/">https://www.odoo.com/documentation/user/</a></li>
<li>User Training Videos: <a class="reference external" href="https://www.odoo.com/slides/all">https://www.odoo.com/slides/all</a></li>
<li>Great Community: OCA =D</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>TIP: A good developer must seek functional understanding. If you know a module that has functionality similar to the one you want to develop, you can get good ideas by reading it.</li>
</ul>
</div>




</article>
<article class="slide level-2" id="the-odoo-community-association">

<h2>The Odoo Community Association</h2>

<p>The Odoo Community Association, or OCA, is a nonprofit organization whose mission is to
promote the widespread use of Odoo and to support the collaborative development
of Odoo features.</p>
<ul class="simple">
<li>Website: <a class="reference external" href="https://odoo-community.org/">https://odoo-community.org/</a></li>
<li>Discord Channel: <a class="reference external" href="https://discord.gg/tNby4ku">https://discord.gg/tNby4ku</a></li>
<li>Mailing Lists: <a class="reference external" href="https://odoo-community.org/groups">https://odoo-community.org/groups</a></li>
</ul>




</article>
<article class="slide level-2" id="id3">

<h2>The Odoo Community Association</h2>

<ul class="simple">
<li><dl class="first docutils">
<dt>3000+ Odoo Modules with high quality code:</dt><dd><ul>
<li>Search here: <a class="reference external" href="https://odoo-community.org/shop">https://odoo-community.org/shop</a></li>
<li>Find the code: <a class="reference external" href="https://github.com/oca">https://github.com/oca</a></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>OCA contributors use Twitter a lot! Find who they are here: <a class="reference external" href="https://github.com/orgs/OCA/people">https://github.com/orgs/OCA/people</a> and follow them.</li>
</ul>
</div>




</article>
<article class="slide level-2" id="odoo-oca">

<h2>Odoo + OCA:</h2>

<img alt="_images/eco.png" class="align-center" src="_images/eco.png" />




</article>
<article class="slide level-1" id="docker-environment">

<h1>Docker environment</h1>





</article>
<article class="slide level-2" id="id1">

<h2>Docker environment</h2>

<p>Although there are many ways to run Odoo, it’s important to know how to deploy it manually, because if you have a problem with docker, you will really need to know the basics.</p>
<p>If you don’t know it very well, check the Odoo doc:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">odoo</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">documentation</span><span class="o">/</span><span class="mf">14.0</span><span class="o">/</span><span class="n">setup</span><span class="o">/</span><span class="n">install</span><span class="o">.</span><span class="n">html</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">odoo</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">documentation</span><span class="o">/</span><span class="mf">14.0</span><span class="o">/</span><span class="n">setup</span><span class="o">/</span><span class="n">deploy</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="id4">

<h2>Docker environment</h2>

<p>There are a lot of good docker implementations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">odoo</span><span class="o">/</span><span class="n">docker</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">acsone</span><span class="o">/</span><span class="n">odoo</span><span class="o">-</span><span class="n">bedrock</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Tecnativa</span><span class="o">/</span><span class="n">doodba</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">camptocamp</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">odoo</span><span class="o">-</span><span class="n">project</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="camptocamp-docker-odoo-project">

<h3>Camptocamp - Docker Odoo project</h3>

<p>Main components:</p>
<ol class="arabic simple">
<li><strong>Docker project</strong>: <a class="reference external" href="https://github.com/camptocamp/docker-odoo-project">https://github.com/camptocamp/docker-odoo-project</a></li>
<li><strong>Marabunta</strong> (Used to provide an easy way to create Updates for Odoo fast and run easily): <a class="reference external" href="https://github.com/camptocamp/marabunta">https://github.com/camptocamp/marabunta</a></li>
<li><strong>Anthem</strong> (Help scripting Odoo instances for automated setup, upgrades, testing and more): <a class="reference external" href="https://github.com/camptocamp/anthem">https://github.com/camptocamp/anthem</a></li>
</ol>




</article>
<article class="slide level-3" id="akretion-ak">

<h3>Akretion - AK</h3>

<p>The toolbelt for odoo: <a class="reference external" href="https://github.com/akretion/ak">https://github.com/akretion/ak</a></p>
<p>It does a lot of things, but in this training we will use it for only two:</p>
<ol class="arabic simple">
<li>Download the addons</li>
<li>Generate addons path</li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1">#Install with a normal user</span>
python3 -m pip install git+https://github.com/akretion/ak --user
</pre></div>
</div>




</article>
<article class="slide level-2" id="before-start">

<h2>Before start</h2>

<p>You will need to ensure a few things:</p>
<ol class="arabic simple">
<li>Docker installed and running: <a class="reference external" href="https://docs.docker.com/get-docker/">https://docs.docker.com/get-docker/</a></li>
<li>Docker Compose: <a class="reference external" href="https://docs.docker.com/compose/install/">https://docs.docker.com/compose/install/</a></li>
<li>Python 3</li>
<li>Python Pip <a class="reference external" href="https://pip.pypa.io/en/stable/installing/">https://pip.pypa.io/en/stable/installing/</a></li>
<li>Install Akretion AK</li>
</ol>




</article>
<article class="slide level-2" id="setup-odoo-environment">

<h2>Setup Odoo Environment</h2>

<p>We will start from a pre-configured repository. To know more about it you must study a
little about the camptocamp docker-odoo-project, docker itself and other used components
like postgresql and traefik.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/kmee/oca-days-2020-odoo-developer.git --branch<span class="o">=</span>template
<span class="nb">cd</span> oca-days-2020-odoo-developer-source
</pre></div>
</div>




</article>
<article class="slide level-2" id="id5">

<h2>Setup Odoo Environment</h2>

<p>You will have the folder structure above:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="p">|</span>-- dev.docker-compose.yml
<span class="p">|</span>── docker-compose.yml
<span class="p">|</span>── odoo
    <span class="p">|</span>── data
    <span class="p">|</span>── dev_oca_days.egg-info
    <span class="p">|</span>── Dockerfile
    <span class="p">|</span>── external-src  <span class="c1"># Downloaded OCA repositories source code</span>
    <span class="p">|</span>── links
    <span class="p">|</span>── local-src   <span class="c1"># Your customer modules</span>
    <span class="p">|</span>── MANIFEST.in
    <span class="p">|</span>── migration.yml  <span class="c1"># Migration Scripts</span>
    <span class="p">|</span>── repo.yaml
    <span class="p">|</span>── requirements.txt  <span class="c1"># Extra requirements for your project</span>
    <span class="p">|</span>── setup.py
    <span class="p">|</span>── songs  <span class="c1">#  Scripts with antherm</span>
    <span class="p">|</span>── spec.yaml  <span class="c1"># Source Code specification: Where download Odoo and OCA repos.</span>
    <span class="p">|</span>── src  <span class="c1"># Downloaded Odoo Source Code</span>
    <span class="p">|</span>── VERSION
</pre></div>
</div>




</article>
<article class="slide level-3" id="setup-the-project">

<h3>Setup the project</h3>

<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inside de project go to Odoo folder</span>
<span class="nb">cd</span> training
<span class="nb">cd</span> odoo
<span class="c1"># Run **ak build** to download the sources</span>
ak build
<span class="c1"># To know more about what this command is doing read the file spec.yml</span>
<span class="c1">#</span>
<span class="c1"># Go back to the main folder</span>
<span class="nb">cd</span> ..
<span class="c1"># Build the Odoo Docker</span>
docker-compose build
<span class="c1"># To know more about what this command is doing read the file odoo/Dockerfile</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="running-odoo">

<h2>Running Odoo</h2>

<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># In the project&#39;s root folder</span>
docker-compose up
<span class="c1"># To stop press CTRL + C</span>
</pre></div>
</div>
<p>Check <a class="reference external" href="https://odoo.localhost">https://odoo.localhost</a></p>




</article>
<article class="slide level-2" id="adding-oca-projects-modules">

<h2>Adding OCA projects / modules</h2>

<p>Now that we have the Odoo up and running, let’s add a new project to improve it.</p>
<ol class="arabic simple">
<li>Go to <a class="reference external" href="https://odoo-community.org/shop">https://odoo-community.org/shop</a> and search for <strong>Responsive</strong>;</li>
<li>Open the module <strong>web_responsive</strong>, from Tecnativa and LasLabs, go to the website(<a class="reference external" href="https://github.com/OCA/web">https://github.com/OCA/web</a>)</li>
<li>Copy the link.</li>
<li>Edit spec.yml</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can use Odoo SA shop to search modules too, but take a special attention in the author of the module.</p>
</div>




</article>
<article class="slide level-2" id="id6">

<h2>Adding OCA projects / modules</h2>

<p>Editing spec.yml:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>odoo:
    modules: <span class="o">[]</span>
    src: https://github.com/odoo/odoo <span class="m">13</span>.0

<span class="hll">web:
</span><span class="hll">    modules: <span class="o">[]</span>
</span><span class="hll">    src: https://github.com/OCA/web <span class="m">13</span>.0
</span></pre></div>
</div>




</article>
<article class="slide level-2" id="id7">

<h2>Adding OCA projects / modules</h2>

<p>When <strong>ak build</strong> has finished running it displays new addons path that you can must put in your docker-compose file</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ak build
<span class="o">[</span>...<span class="o">]</span>
<span class="o">(</span>INFO<span class="o">)</span> <span class="o">[</span><span class="m">07</span>:21:45<span class="o">]</span> git_aggregator.repo  src   End aggregation of /home/mileo/Projects/oca-days-2020/oca-days-2020-odoo-developer-source/odoo/src
<span class="hll">Addons path <span class="k">for</span> your config file:  /odoo/links,/odoo/local-src,/odoo/src/odoo/addons,/odoo/src/addons,/odoo/external-src/web
</span></pre></div>
</div>
<p>TIP: This will add all the modules of the project OCA/web, if you just want the web_responsive you can use the following syntax:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>odoo:
    modules: <span class="o">[]</span>
    src: https://github.com/odoo/odoo <span class="m">13</span>.0

web:
<span class="hll">    modules: <span class="o">[</span><span class="s1">&#39;web_responsive&#39;</span><span class="o">]</span>
</span>    src: https://github.com/OCA/web <span class="m">13</span>.0
</pre></div>
</div>




</article>
<article class="slide level-2" id="id8">

<h2>Adding OCA projects / modules</h2>

<p>Edit your docker compose to update the ADDONS_PATH</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>services:
  odoo:
    environment:
      - <span class="nv">PYTHONDONTWRITEBYTECODE</span><span class="o">=</span>True
      - <span class="nv">LOCAL_USER_ID</span><span class="o">=</span><span class="nv">$UID</span>
      <span class="o">[</span>...<span class="o">]</span>
      - <span class="nv">DB_PASS</span><span class="o">=</span><span class="nv">$PGPASSWORD</span>
      - <span class="nv">PGHOST</span><span class="o">=</span><span class="nv">$PGHOST</span>
      - <span class="nv">PGDATABASE</span><span class="o">=</span><span class="nv">$PGDATABASE</span>
      - <span class="nv">PGUSER</span><span class="o">=</span><span class="nv">$PGUSER</span>
      - <span class="nv">PGPASSWORD</span><span class="o">=</span><span class="nv">$PGPASSWORD</span>
<span class="hll">      - <span class="nv">ADDONS_PATH</span><span class="o">=</span>/odoo/links,/odoo/local-src,/odoo/src/odoo/addons,/odoo/src/addons,/odoo/external-src/web
</span>    hostname: <span class="si">${</span><span class="nv">ENV</span><span class="si">}</span>-<span class="si">${</span><span class="nv">COMPOSE_PROJECT_NAME</span><span class="si">}</span>
    labels:
      docky.main.service: <span class="nb">true</span>
      docky.user: odoo
    volumes:
      - ./odoo:/odoo
      - ./data/addons:/data/odoo/addons
      <span class="o">[</span>...<span class="o">]</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="id9">

<h2>Adding OCA projects / modules</h2>

<p>To auto install web_responsive with a migration script, edit you PROJECT_ROOT/odoo/migration.yml</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>migration:
  options:
    install_command: odoo
  versions:
    - version: <span class="m">13</span>.0.0.0.0
      <span class="o">[</span>...<span class="o">]</span>
      modes:
        demo:
          operations:
            post:
              - anthem songs.install.demo::main
<span class="hll">    - version: <span class="m">13</span>.0.0.0.1
</span><span class="hll">      addons:
</span><span class="hll">        upgrade:
</span><span class="hll">          - web_responsive
</span></pre></div>
</div>




</article>
<article class="slide level-1" id="coding-our-first-module">

<h1>Coding our first module</h1>





</article>
<article class="slide level-2" id="id2">

<h2>Coding our first module</h2>

<p>In our example module we will create an application for customer service management:
with Kanban and personalized workflow, integration with email and sms.</p>
<p>To help us we will use the <a class="reference external" href="https://github.com/acsone/bobtemplates.odoo">https://github.com/acsone/bobtemplates.odoo</a> install it
in your local user:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install bobtemplates.odoo
</pre></div>
</div>




</article>
<article class="slide level-3" id="create-your-module-skeletton">

<h3>Create your module skeletton</h3>

<p>Run bob the command inside de folder local-src and answer the questions:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> PROJECT_ROOT/odoo/local-src
<span class="hll">mrbob bobtemplates.odoo:addon
</span>
Welcome to mr.bob interactive mode. Before we generate directory structure,
some questions need to be answered.

Answer with a question mark to display help.
Values in square brackets at the end of the questions show the
default value <span class="k">if</span> there is no answer.
<span class="hll">
</span><span class="hll">--&gt; Addon name <span class="o">(</span>with underscores<span class="o">)</span>: customer_service
</span><span class="hll">--&gt; Is it an OCA addon <span class="o">[</span>n<span class="o">]</span>:
</span><span class="hll">--&gt; Summary: ACME Customer Service
</span><span class="hll">--&gt; Version <span class="o">[</span><span class="m">12</span>.0.1.0.0<span class="o">]</span>: <span class="m">13</span>.0.1.0.0
</span><span class="hll">--&gt; Copyright holder name: KMEE
</span><span class="hll">--&gt; Copyright year: <span class="m">2020</span>
</span><span class="hll">--&gt; Website: www.kmee.com.br
</span>
Generated file structure at PROJECT_ROOT/odoo/local-src
</pre></div>
</div>




</article>
<article class="slide level-3" id="id10">

<h3>Create your module skeletton</h3>

<p>You will have the following file structure:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="p">|</span>── customer_service
│   <span class="p">|</span>── __init__.py  <span class="c1"># All Odoo modules are python modules</span>
│   <span class="p">|</span>── __manifest__.py  <span class="c1"># Module manifest: Here you will have the name, dependencies, authors and etc</span>
<span class="p">|</span>── README.md  <span class="c1"># Description of the module, as displayed on github or OCA website.</span>
</pre></div>
</div>
<p>Add our module to the migration file, in a new version.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>    <span class="o">[</span>...<span class="o">]</span>
    - version: <span class="m">13</span>.0.0.0.1
      addons:
<span class="hll">          - web_responsive
</span><span class="hll">    - version: <span class="m">13</span>.0.0.0.2
</span><span class="hll">      addons:
</span>          - customer_service
</pre></div>
</div>
<p>Run Odoo an check that our module ir already installed.</p>
<p>TIP: When you are starting developing, the best way to go further is with little baby steps.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>To learn more:</dt><dd><ul class="simple">
<li>You can see a complete Odoo manifest here: <a class="reference external" href="https://github.com/OCA/maintainer-tools/blob/master/template/module/__manifest__.py">https://github.com/OCA/maintainer-tools/blob/master/template/module/__manifest__.py</a></li>
<li>The official documentation: <a class="reference external" href="https://www.odoo.com/documentation/14.0/reference/module.html">https://www.odoo.com/documentation/14.0/reference/module.html</a></li>
</ul>
</dd>
</dl>
</div>




</article>
<article class="slide level-3" id="adding-a-new-business-model-to-our-module">

<h3>Adding a new Business Model to our module</h3>

<p>A model will represent the Business process, the data that you want to store and
behaviors of the data you’re storing.</p>
<p>The basics:</p>
<ul class="simple">
<li>Each model is a Python class that subclasses odoo.models.Model.</li>
<li>Each model is generally maps to a single database table.</li>
<li>Each attribute of the model represents a database field.</li>
<li>With all of this, Odoo gives you an automatically-generated database-access API; see Making queries.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>To learn more:</dt><dd><ul class="simple">
<li>Check the Odoo documentation: <a class="reference external" href="https://www.odoo.com/documentation/14.0/reference/orm.html">https://www.odoo.com/documentation/14.0/reference/orm.html</a></li>
<li><dl class="first docutils">
<dt>Please read the Odoo code:</dt><dd><ul>
<li>odoo/src/odoo/models.py</li>
<li>odoo/src/odoo/fields.py</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</div>




</article>
<article class="slide level-3" id="id11">

<h3>Adding a new Business Model to our module</h3>

<p>For example a CRM LEAD of Odoo Core crm module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Lead</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s2">&quot;crm.lead&quot;</span>
    <span class="n">_description</span> <span class="o">=</span> <span class="s2">&quot;Lead/Opportunity&quot;</span>
    <span class="c1">#[...]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="s1">&#39;Opportunity&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">partner_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;Customer&#39;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Linked partner (optional). Usually created when converting the lead. You can find a partner by its Name, TIN, Email or Internal Reference.&quot;</span><span class="p">)</span>
    <span class="n">active</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="s1">&#39;Active&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">email_from</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="s1">&#39;Email&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Email address of the contact&quot;</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Notes&#39;</span><span class="p">)</span>
    <span class="c1">#[...]</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id12">

<h3>Adding a new Business Model to our module</h3>

<p>With the help o bob.odoo we will create our first Odoo model with accompanying form, tree, action, menu, demo data and ACL</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> customer_service <span class="c1"># Go inside de module folder that you want to create the model</span>
<span class="hll">mrbob bobtemplates.odoo:model
</span>
Welcome to mr.bob interactive mode. Before we generate directory structure, some questions
need to be answered. Answer with a question mark to display help. Values in square
brackets at the end of the questions show the default value <span class="k">if</span> there is no answer.
--&gt; Odoo version <span class="o">(</span><span class="m">8</span><span class="p">|</span><span class="m">9</span><span class="p">|</span><span class="m">10</span><span class="p">|</span><span class="m">11</span><span class="p">|</span><span class="m">12</span><span class="o">)</span> <span class="o">[</span><span class="m">12</span><span class="o">]</span>: <span class="m">13</span>
<span class="hll">--&gt; Model name <span class="o">(</span>dotted notation<span class="o">)</span>: customer.service.ticket
</span><span class="hll">--&gt; Inherit <span class="o">[</span>y<span class="o">]</span>: n
</span><span class="hll">--&gt; Form view <span class="o">[</span>y<span class="o">]</span>: y
</span><span class="hll">--&gt; Search view <span class="o">[</span>y<span class="o">]</span>: y
</span><span class="hll">--&gt; Tree view <span class="o">[</span>y<span class="o">]</span>: y
</span><span class="hll">--&gt; Action and menu entry <span class="o">[</span>y<span class="o">]</span>: y
</span><span class="hll">--&gt; ACL <span class="o">[</span>y<span class="o">]</span>: y
</span><span class="hll">--&gt; Demo data <span class="o">[</span>y<span class="o">]</span>: y
</span><span class="hll">--&gt; Copyright holder name: KMEE
</span><span class="hll">--&gt; Copyright year: <span class="m">2020</span>
</span><span class="hll">Generated file structure at PROJECT_ROOT/odoo/local-src/customer_service
</span></pre></div>
</div>




</article>
<article class="slide level-3" id="id13">

<h3>Adding a new Business Model to our module</h3>

<p>You will have the following file structure:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="p">|</span>── customer_service
│   <span class="p">|</span>── demo
│   │   <span class="p">|</span>── customer_service_ticket.xml
│   <span class="p">|</span>── __init__.py  <span class="c1"># Updated with the model import</span>
│   <span class="p">|</span>── __manifest__.py  <span class="c1"># Update with the imports of demo/security and views.</span>
│   <span class="p">|</span>── models
│   │   <span class="p">|</span>── customer_service_ticket.py <span class="c1"># Your module definition.</span>
│   │   <span class="p">|</span>── __init__.py
│   <span class="p">|</span>── security
│   │   <span class="p">|</span>── customer_service_ticket.xml <span class="c1"># User access rules</span>
│   <span class="p">|</span>── views
│       <span class="p">|</span>── customer_service_ticket.xml <span class="c1"># Our views: tree, form, search, kanban.</span>
<span class="p">|</span>── README.md
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>To learn more:</dt><dd><ul class="simple">
<li>You can see here a complete Odoo module: <a class="reference external" href="https://github.com/OCA/maintainer-tools/blob/master/template/module/">https://github.com/OCA/maintainer-tools/blob/master/template/module/</a></li>
</ul>
</dd>
</dl>
</div>




</article>
<article class="slide level-3" id="id14">

<h3>Adding a new Business Model to our module</h3>

<p>Before install it we need to fix some settings:</p>
<ol class="arabic simple">
<li>Create a main menu</li>
<li>Relate customer service menu with main menu</li>
<li>Ensure create / write / delete user access rules</li>
</ol>




</article>
<article class="slide level-3" id="id15">

<h3>Adding a new Business Model to our module</h3>

<p>To create a main menu we need a icon, for that we will use a standard item, download from Odoo webiste:
<a class="reference external" href="https://www.odoo.com/pt_BR/page/brand-assets">https://www.odoo.com/pt_BR/page/brand-assets</a></p>
<p>Create the following folder structure inside the module and save it: <strong>odoo/local-src/customer_service/static/description/icon.png</strong></p>
<p>Inside de folder views, create a new file: <strong>customer_service/views/customer_service_menu.xml</strong></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;odoo&gt;</span>
    <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.menu&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_main_menu&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Customer Service<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;sequence&quot;</span> <span class="na">eval=</span><span class="s">&quot;40&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;web_icon&quot;</span><span class="nt">&gt;</span>customer_service,static/description/icon.png<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;/record&gt;</span>
<span class="nt">&lt;/odoo&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>To learn more:</dt><dd><ul class="simple">
<li>Read more about the views at the official documentation: <a class="reference external" href="https://www.odoo.com/documentation/14.0/reference/views.html">https://www.odoo.com/documentation/14.0/reference/views.html</a></li>
</ul>
</dd>
</dl>
</div>




</article>
<article class="slide level-3" id="id16">

<h3>Adding a new Business Model to our module</h3>

<p>Edit the module manifest to import the main menu:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Customer Service&#39;</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        ACME Customer Service&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;13.0.1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;license&#39;</span><span class="p">:</span> <span class="s1">&#39;AGPL-3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;KMEE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;website&#39;</span><span class="p">:</span> <span class="s1">&#39;www.kmee.com.br&#39;</span><span class="p">,</span>
    <span class="s1">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">],</span>
    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;security/customer_service_ticket.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s1">&#39;views/customer_service_menu.xml&#39;</span><span class="p">,</span>
</span>        <span class="s1">&#39;views/customer_service_ticket.xml&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>Ensure that you put it before the customer_service_ticket, <strong>the order matters</strong>.</p>




</article>
<article class="slide level-3" id="id17">

<h3>Adding a new Business Model to our module</h3>

<p>Let’s relate the service ticket menu with our new main menu, open the file: <strong>odoo/local-src/customer_service/views/customer_service_ticket.xml</strong> and edit the last section:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span>[...]
<span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.menu&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_menu&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Customer Service Ticket<span class="nt">&lt;/field&gt;</span>
<span class="hll">    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;parent_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;customer_service_main_menu&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- The id of the main menu --&gt;</span>
</span>    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action&quot;</span> <span class="na">ref=</span><span class="s">&quot;customer_service_ticket_act_window&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;sequence&quot;</span> <span class="na">eval=</span><span class="s">&quot;16&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>To learn more:</dt><dd><ul class="simple">
<li>You can see here a complete Odoo module: <a class="reference external" href="https://github.com/OCA/maintainer-tools/blob/master/template/module/">https://github.com/OCA/maintainer-tools/blob/master/template/module/</a></li>
</ul>
</dd>
</dl>
</div>




</article>
<article class="slide level-3" id="id18">

<h3>Adding a new Business Model to our module</h3>

<p>Edit
<strong>odoo/local-src/customer_service/security/customer_service_ticket.xml</strong>
changing all the permissions to <strong>ONE</strong></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;odoo&gt;</span>
    <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.model.access&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_access_name&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- TODO acl id --&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>customer.service.ticket access name<span class="nt">&lt;/field&gt;</span> <span class="c">&lt;!-- TODO acl name --&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;model_customer_service_ticket&quot;</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!-- TODO review and adapt --&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;group_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;base.group_user&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_read&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="hll">        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_create&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_write&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_unlink&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</span>    <span class="nt">&lt;/record&gt;</span>
<span class="nt">&lt;/odoo&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="updating-your-odoo-module-manually">

<h3>Updating your Odoo module manually</h3>

<p>If your docker-composed is already running, stop it. Run it with the folllowing parameters:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker-compose run --rm -e <span class="nv">DB_NAME</span><span class="o">=</span>dev-oca-days odoo odoo -u customer_service --stop-after-init
<span class="c1"># This command will run Odoo, update the module customer_service,</span>
<span class="c1"># installed on the database dev-oca-days and when finished will stop the Odoo.</span>
<span class="c1"># Start Odoo again as normally</span>
docker-compose up
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Odoo command line interface: <a class="reference external" href="https://www.odoo.com/documentation/14.0/reference/cmdline.html">https://www.odoo.com/documentation/14.0/reference/cmdline.html</a></p>
</div>




</article>
<article class="slide level-2" id="adding-fields-to-our-model">

<h2>Adding fields to our model</h2>

<p>At this moment you must we have a basic module, that we can install, save and edit data. With a tree view and a form view.
But we need more, let’s edit <em>odoo/local-src/customer_service/models/customer_service_ticket.py</em> and add some fields.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">api</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">CustomerServiceTicket</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;customer.service.ticket&#39;</span>
    <span class="n">_description</span> <span class="o">=</span> <span class="s1">&#39;Customer Service Ticket&#39;</span>  <span class="c1"># TODO</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">()</span>
<span class="hll">    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Html</span><span class="p">(</span><span class="n">sanitize_style</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span class="hll">    <span class="n">user_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.users&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">partner_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">partner_email</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">related</span><span class="o">=</span><span class="s1">&#39;partner_id.email&#39;</span><span class="p">)</span>
</span></pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Check more about the Odoo fields: <a class="reference external" href="https://www.odoo.com/documentation/14.0/reference/orm.html#fields">https://www.odoo.com/documentation/14.0/reference/orm.html#fields</a></li>
<li>odoo/src/odoo/fields.py &lt;——- There is nothing better than reading the source code!!!!</li>
</ul>
</div>




</article>
<article class="slide level-2" id="id19">

<h2>Adding fields to our model</h2>

<p>We need to add this new fields to the view, check your <strong>odoo/local-src/customer_service/views/customer_service_ticket.xml</strong>, you will see
that are five blocks of code:</p>
<ol class="arabic simple">
<li>Form view;</li>
<li>Search / Filter View (Add Filter, Group and Favorites search);</li>
<li>Tree / List view;</li>
<li>Action (Speaking in a very simple way, links the menu with the views);</li>
<li>Menu;</li>
</ol>




</article>
<article class="slide level-2" id="id20">

<h2>Adding fields to our model</h2>

<p>Add the all the new fields to the form view:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_form_view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>customer.service.ticket.form (in customer_service)<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>customer.service.ticket<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form&gt;</span>
            <span class="nt">&lt;header&gt;</span>
            <span class="nt">&lt;/header&gt;</span>
            <span class="nt">&lt;sheet&gt;</span>
                <span class="nt">&lt;group&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;user_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_email&quot;</span><span class="nt">/&gt;</span>
</span>                <span class="nt">&lt;/group&gt;</span>
            <span class="nt">&lt;/sheet&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_chatter&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/form&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="id21">

<h2>Adding fields to our model</h2>

<p>Add the some fields to the tree view:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_tree_view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>customer.service.ticket.tree (in customer_service)<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>customer.service.ticket<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tree&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;user_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_id&quot;</span><span class="nt">/&gt;</span>
</span>        <span class="nt">&lt;/tree&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="add-a-kanban-workflow">

<h2>Add a Kanban / Workflow</h2>

<p>To quick add a Kanban without coding a lot we will use a very nice OCA module: <strong>base_kanban_stage</strong></p>
<p>In the moment of this talk the module isn’t migrated wet to version 13.0, then we will use a pull request instead of the main branch.
This is a good way to review other contributors work. Just be careful if you will gonna use it for production enviroment.</p>
<p><a class="reference external" href="https://github.com/OCA/server-tools/pull/1799">https://github.com/OCA/server-tools/pull/1799</a></p>




</article>
<article class="slide level-2" id="id22">

<h2>Add a Kanban / Workflow</h2>

<p>Lets add it to spec.yaml:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">odoo</span><span class="p">:</span>
    <span class="nt">modules</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/odoo/odoo 13.0</span>

<span class="nt">web</span><span class="p">:</span>
    <span class="nt">modules</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
<span class="hll">    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/OCA/web 13.0</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">kmee-server-tools</span><span class="p">:</span>
</span>    <span class="nt">modules</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;base_kanban_stage&#39;</span><span class="p p-Indicator">]</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/kmee/server-tools 13.0-mig-base_kanban_stage</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="add-base-kanban-stage-to-our-module-dependencies">

<h3>Add base_kanban_stage to our module dependencies</h3>

<p>The first step is to add base_kanban_stage to our module dependencies list. To do that we need to change the module manifest, by editing the <strong>odoo/local-src/customer_service/__manifest__.py</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Customer Service&#39;</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        ACME Customer Service&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;13.0.1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;license&#39;</span><span class="p">:</span> <span class="s1">&#39;AGPL-3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;KMEE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;website&#39;</span><span class="p">:</span> <span class="s1">&#39;www.kmee.com.br&#39;</span><span class="p">,</span>
    <span class="s1">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span>
<span class="hll">        <span class="s1">&#39;base_kanban_stage&#39;</span><span class="p">,</span>
</span>    <span class="p">],</span>
    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;security/customer_service_ticket.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/customer_service_menu.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/customer_service_ticket.xml&#39;</span><span class="p">,</span>
    <span class="p">],</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="inherit-base-kanban-abstract-in-our-model">

<h3>Inherit base.kanban.abstract in our model</h3>

<dl class="docutils">
<dt>Inherit from <code class="docutils literal notranslate"><span class="pre">base.kanban.abstract</span></code> to add Kanban stage functionality to</dt><dd>the customer.service.ticket:</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomerServiceTicket</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;customer.service.ticket&#39;</span>
<span class="hll">    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;base.kanban.abstract&#39;</span>
</span></pre></div>
</div>
<p>By doing that we add all the functionalists of the model ‘base.kanban.abstract’ in our model.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>To learn more:</dt><dd><ul class="simple">
<li>Odoo provides two inheritance mechanisms to extend an existing model in a modular way. <a class="reference external" href="https://www.odoo.com/documentation/14.0/howtos/backend.html?highlight=inherit#inheritance">https://www.odoo.com/documentation/14.0/howtos/backend.html?highlight=inherit#inheritance</a></li>
</ul>
</dd>
</dl>
</div>




</article>
<article class="slide level-3" id="id23">

<h3>Inherit base.kanban.abstract in our model</h3>

<p>Add a new view record at <strong>customer_service_ticket.xml</strong> and the <strong>kanban</strong> to the view_mode</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_kanban_view&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>customer.service.ticket.kanban (in customer_service)<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>customer.service.ticket<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;mode&quot;</span><span class="nt">&gt;</span>primary<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inherit_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;base_kanban_stage.base_kanban_abstract_view_kanban&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">        <span class="nt">&lt;xpath</span> <span class="na">expr=</span><span class="s">&quot;//div[@name=&#39;card_body&#39;]&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/xpath&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/field&gt;</span>
</span><span class="hll"><span class="nt">&lt;/record&gt;</span>
</span>
<span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_act_window&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Customer Service Ticket<span class="nt">&lt;/field&gt;</span> <span class="c">&lt;!-- TODO --&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>customer.service.ticket<span class="nt">&lt;/field&gt;</span>
<span class="hll">    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>kanban,tree,form<span class="nt">&lt;/field&gt;</span>
</span>    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;domain&quot;</span><span class="nt">&gt;</span>[]<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;context&quot;</span><span class="nt">&gt;</span>{}<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id24">

<h3>Inherit base.kanban.abstract in our model</h3>

<p>We need to change the form view too, to add the field stage_id to the header:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_form_view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>customer.service.ticket.form (in customer_service)<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>customer.service.ticket<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form&gt;</span>
            <span class="nt">&lt;header&gt;</span>
<span class="hll">                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;stage_id&quot;</span> <span class="na">widget=</span><span class="s">&quot;statusbar&quot;</span><span class="nt">/&gt;</span>
</span>            <span class="nt">&lt;/header&gt;</span>
            <span class="nt">&lt;sheet&gt;</span>
                <span class="nt">&lt;group&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;user_id&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_id&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_email&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/group&gt;</span>
            <span class="nt">&lt;/sheet&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_chatter&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="add-email-features">

<h2>Add Email features</h2>

<p>To add email features to our model, first we need to:</p>
<ol class="arabic simple">
<li>Add mail module to our module dependencies;</li>
<li>Add <strong>mail.thread</strong> to the inherit list of your model, same as we did with <strong>base.kanban.abstract</strong></li>
<li>Improve the view to display the email fields;</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>To learn more:</dt><dd><ul class="simple">
<li>Odoo implements some useful classes and mixins that make it easy for you to add often-used behaviours on your objects. This guide will details most of them, with examples and use cases. <a class="reference external" href="https://www.odoo.com/documentation/14.0/reference/mixins.html?highlight=inherit">https://www.odoo.com/documentation/14.0/reference/mixins.html?highlight=inherit</a></li>
</ul>
</dd>
</dl>
</div>




</article>
<article class="slide level-2" id="id25">

<h2>Add Email features</h2>

<ol class="arabic simple">
<li>Add dependence:</li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Customer Service&#39;</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        ACME Customer Service&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;13.0.1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;license&#39;</span><span class="p">:</span> <span class="s1">&#39;AGPL-3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;KMEE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;website&#39;</span><span class="p">:</span> <span class="s1">&#39;www.kmee.com.br&#39;</span><span class="p">,</span>
    <span class="s1">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;base_kanban_stage&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s1">&#39;mail,</span>
</span>    <span class="p">],</span>
    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;security/customer_service_ticket.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/customer_service_menu.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/customer_service_ticket.xml&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;demo/customer_service_ticket.xml&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="id26">

<h2>Add Email features</h2>

<ol class="arabic simple" start="2">
<li>Add <strong>mail.thread</strong> to the inherit list of your model:</li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomerServiceTicket</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;customer.service.ticket&#39;</span>
<span class="hll">    <span class="n">_inherit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;base.kanban.abstract&#39;</span><span class="p">,</span> <span class="s1">&#39;mail.thread&#39;</span><span class="p">]</span>
</span></pre></div>
</div>




</article>
<article class="slide level-2" id="id27">

<h2>Add Email features</h2>

<ol class="arabic simple" start="3">
<li>Improve the view;</li>
</ol>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_form_view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>customer.service.ticket.form (in customer_service)<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>customer.service.ticket<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form&gt;</span>
            <span class="nt">&lt;header&gt;</span>
                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;stage_id&quot;</span> <span class="na">widget=</span><span class="s">&quot;statusbar&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/header&gt;</span>
            <span class="nt">&lt;sheet&gt;</span>
                <span class="nt">&lt;group&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;user_id&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_id&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_email&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/group&gt;</span>
            <span class="nt">&lt;/sheet&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_chatter&quot;</span><span class="nt">&gt;</span>
<span class="hll">                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;message_follower_ids&quot;</span> <span class="na">widget=</span><span class="s">&quot;mail_followers&quot;</span> <span class="na">groups=</span><span class="s">&quot;base.group_user&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;message_ids&quot;</span> <span class="na">widget=</span><span class="s">&quot;mail_thread&quot;</span><span class="nt">/&gt;</span>
</span>            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/form&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="sending-sms">

<h2>Sending SMS</h2>

<p>Odoo and Odoo SA has his own provider to send SMS, but we will override this behavior to
send SMS with the provider of our choice.</p>
<p>To do that we will create a new module called <strong>sms_nexmo</strong> and we will propose it to OCA.</p>
<p>Here is an example of how to send SMS via nexmo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nexmo</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">nexmo.sms</span> <span class="kn">import</span> <span class="n">Sms</span>

<span class="n">sms</span> <span class="o">=</span> <span class="n">Sms</span><span class="p">(</span><span class="n">Client</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;60e5d109&#39;</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="s1">&#39;************NMX&#39;</span><span class="p">))</span>

<span class="n">sms</span><span class="o">.</span><span class="n">send_message</span><span class="p">({</span>
    <span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="s1">&#39;Vonage APIs&#39;</span><span class="p">,</span>
    <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="s1">&#39;5535988763663&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;Hello from Vonage SMS API&#39;</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="id28">

<h2>Sending SMS</h2>

<p>Odoo SA has a module <strong>sms</strong> which has two methods that we need to override, here is the Odoo SA code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SmsApi</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">AbstractModel</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;sms.api&#39;</span>
    <span class="n">_description</span> <span class="o">=</span> <span class="s1">&#39;SMS API&#39;</span>

    <span class="nd">@api</span><span class="o">.</span><span class="n">model</span>
    <span class="k">def</span> <span class="nf">_contact_iap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_endpoint</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">account</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;iap.account&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sms&#39;</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;account_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">account_token</span>
        <span class="n">endpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;ir.config_parameter&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sudo</span><span class="p">()</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="s1">&#39;sms.endpoint&#39;</span><span class="p">,</span> <span class="n">DEFAULT_ENDPOINT</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">iap</span><span class="o">.</span><span class="n">jsonrpc</span><span class="p">(</span><span class="n">endpoint</span> <span class="o">+</span> <span class="n">local_endpoint</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

    <span class="nd">@api</span><span class="o">.</span><span class="n">model</span>
<span class="hll">    <span class="k">def</span> <span class="nf">_send_sms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
</span>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;numbers&#39;</span><span class="p">:</span> <span class="n">numbers</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contact_iap</span><span class="p">(</span><span class="s1">&#39;/iap/message_send&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="nd">@api</span><span class="o">.</span><span class="n">model</span>
<span class="hll">    <span class="k">def</span> <span class="nf">_send_sms_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">messages</span><span class="p">):</span>
</span>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;messages&#39;</span><span class="p">:</span> <span class="n">messages</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contact_iap</span><span class="p">(</span><span class="s1">&#39;/iap/sms/1/send&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="creating-a-module-to-be-sent-to-oca">

<h2>Creating a module to be sent to OCA</h2>

<p>This time we will not create the module <strong>sms_nexmo</strong> at local-src folder.
We will create and send a pull request at OCA project: <a class="reference external" href="https://github.com/OCA/connector-telephony">https://github.com/OCA/connector-telephony</a></p>
<p>But to To do that, we need to ensure a feel things:</p>
<ol class="arabic simple">
<li>A fork of this project.</li>
<li>Add our fork to spec.yml</li>
<li>Start coding</li>
<li>Make a pull request</li>
</ol>




</article>
<article class="slide level-3" id="adding-a-fork-to-our-project">

<h3>Adding a Fork to our project</h3>

<p>Go to the project, find the fork button on the upper right side of the screen.
Fork it to your user/organization, and add your remote fork url to spec.yml</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">odoo</span><span class="p">:</span>
    <span class="nt">modules</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/odoo/odoo 13.0</span>

<span class="nt">web</span><span class="p">:</span>
    <span class="nt">modules</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/OCA/web 13.0</span>

<span class="nt">kmee-server-tools</span><span class="p">:</span>
    <span class="nt">modules</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;base_kanban_stage&#39;</span><span class="p p-Indicator">]</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/kmee/server-tools 13.0-mig-base_kanban_stage</span>

<span class="nt">connector-telephony</span><span class="p">:</span>
    <span class="nt">modules</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
    <span class="nt">src</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/YOUR_REMOTE_HERE/connector-telephony 13.0</span>
</pre></div>
</div>
<p>Run <strong>ak build</strong> and update the <strong>addons path</strong></p>




</article>
<article class="slide level-3" id="easy-creating-a-oca-module-with-bobtemplates-odoo">

<h3>Easy creating a OCA module with bobtemplates.odoo</h3>

<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> PROJECT_ROOT/odoo/external-src/connector-telephony
<span class="hll">mrbob bobtemplates.odoo:addon
</span>
Welcome to mr.bob interactive mode. Before we generate directory structure,
some questions need to be answered.

Answer with a question mark to display help.
Values in square brackets at the end of the questions show the
default value <span class="k">if</span> there is no answer.
<span class="hll">
</span><span class="hll">--&gt; Addon name <span class="o">(</span>with underscores<span class="o">)</span>: sms_nexmo
</span><span class="hll">--&gt; Is it an OCA addon <span class="o">[</span>n<span class="o">]</span>: Y
</span><span class="hll">--&gt; Summary: Send SMS with Nexmo instead of Odoo SA IAP.
</span><span class="hll">--&gt; Version <span class="o">[</span><span class="m">12</span>.0.1.0.0<span class="o">]</span>: <span class="m">13</span>.0.1.0.0
</span><span class="hll">--&gt; Copyright holder name: KMEE
</span><span class="hll">--&gt; Copyright year: <span class="m">2020</span>
</span><span class="hll">--&gt; Website: https://github.com/OCA/connector-telephony
</span></pre></div>
</div>




</article>
<article class="slide level-3" id="id29">

<h3>Easy creating a OCA module with bobtemplates.odoo</h3>

<p>You module sms_nexmo must depend of Odoo SA sms module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sms Nexmo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Send SMS with Nexmo instead of Odoo SA IAP.&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;13.0.1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;license&#39;</span><span class="p">:</span> <span class="s1">&#39;AGPL-3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;KMEE,Odoo Community Association (OCA)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;website&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/OCA/connector-telephony&#39;</span><span class="p">,</span>
    <span class="s1">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;sms&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;views/iap_account.xml&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="extending-odoo-models">

<h3>Extending Odoo models</h3>

<p>We will need to change the behavior of two Odoo models:</p>
<ol class="arabic simple">
<li><strong>iap.account</strong>: To save the nexmo key and secret;</li>
<li><strong>sms.api</strong>: To overwrite the methods: _send_sms and _send_sms_batch</li>
</ol>




</article>
<article class="slide level-3" id="extending-odoo-models-iap-account">

<h3>Extending Odoo models: iap.account</h3>

<p>We need to create two new fields at the model iap.account and add it to the form screen.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> PROJECT_ROOT/odoo/external-src/connector-telephony/sms_nexmo
mrbob bobtemplates.odoo:model

Welcome to mr.bob interactive mode. Before we generate directory structure,
some questions need to be answered. Answer with a question mark to display help.
Values in square brackets at the end of the questions show the
default value <span class="k">if</span> there is no answer.

    --&gt; Odoo version <span class="o">(</span><span class="m">8</span><span class="p">|</span><span class="m">9</span><span class="p">|</span><span class="m">10</span><span class="p">|</span><span class="m">11</span><span class="p">|</span><span class="m">12</span><span class="o">)</span> <span class="o">[</span><span class="m">12</span><span class="o">]</span>: <span class="m">13</span>
    --&gt; Model name <span class="o">(</span>dotted notation<span class="o">)</span>: iap.account
    --&gt; Inherit <span class="o">[</span>y<span class="o">]</span>: Y
    --&gt; Form view <span class="o">[</span>y<span class="o">]</span>: Y
    --&gt; Search view <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; Tree view <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; Action and menu entry <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; ACL <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; Demo data <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; Copyright holder name: KMEE
    --&gt; Copyright year: <span class="m">2020</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id30">

<h3>Extending Odoo models: iap.account</h3>

<p>Adding the two fields to the model is very easy, edit the file: <strong>PROJECT_ROOT/odoo/external-src/connector-telephony/sms_nexmo/models/iap_account.py</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">api</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">IapAccount</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;iap.account&#39;</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">()</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">()</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id31">

<h3>Extending Odoo models: iap.account</h3>

<p>To add them to form view, the easy way is to find the view and at developer mode click on View Form View to discover the external id of the main view.</p>
<p>Only with the external id in hand can we edit the inherited view.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;iap_account_form_view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>iap.account.form (in sms_nexmo)<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>iap.account<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inherit_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;iap.iap_account_view_form&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;account_token&quot;</span> <span class="na">position=</span><span class="s">&quot;after&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;key&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;secret&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>TIP: Always remember to use the complete name: &lt;MODULE&gt;&lt;DOT&gt;&lt;RECORD_ID&gt;</li>
<li>Check the documentation about the view inheritance: <a class="reference external" href="https://www.odoo.com/documentation/14.0/reference/views.html?highlight=inherit#inheritance">https://www.odoo.com/documentation/14.0/reference/views.html?highlight=inherit#inheritance</a></li>
</ul>
</div>




</article>
<article class="slide level-3" id="overwriting-odoo-model-sms-api">

<h3>Overwriting Odoo model: sms.api</h3>

<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> PROJECT_ROOT/odoo/external-src/connector-telephony/sms_nexmo
mrbob bobtemplates.odoo:model

Welcome to mr.bob interactive mode. Before we generate directory structure,
some questions need to be answered. Answer with a question mark to display help.
Values in square brackets at the end of the questions show the
default value <span class="k">if</span> there is no answer.

    --&gt; Odoo version <span class="o">(</span><span class="m">8</span><span class="p">|</span><span class="m">9</span><span class="p">|</span><span class="m">10</span><span class="p">|</span><span class="m">11</span><span class="p">|</span><span class="m">12</span><span class="o">)</span> <span class="o">[</span><span class="m">12</span><span class="o">]</span>: <span class="m">13</span>
    --&gt; Model name <span class="o">(</span>dotted notation<span class="o">)</span>: sms.api
    --&gt; Inherit <span class="o">[</span>y<span class="o">]</span>: Y
    --&gt; Form view <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; Search view <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; Tree view <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; Action and menu entry <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; ACL <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; Demo data <span class="o">[</span>y<span class="o">]</span>: n
    --&gt; Copyright holder name: KMEE
    --&gt; Copyright year: <span class="m">2020</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id32">

<h3>Overwriting Odoo model: sms.api</h3>

<p>To send sms we will need an external library: <a class="reference external" href="https://pypi.org/project/nexmo/">https://pypi.org/project/nexmo/</a></p>
<p>We must also not forget to add it to requirements.txt and run the build command again.</p>
<p>odoo/requirements.txt</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">nexmo</span><span class="o">==</span><span class="m">2</span>.5.2
</pre></div>
</div>
<p>And from the PROJECT_ROOT</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker-compose build
</pre></div>
</div>




</article>
<article class="slide level-3" id="id33">

<h3>Overwriting Odoo model: sms.api</h3>

<p>Now we can use it on our python class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">api</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">nexmo</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">nexmo.sms</span> <span class="kn">import</span> <span class="n">Sms</span>

<span class="k">class</span> <span class="nc">SmsApi</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">AbstractModel</span><span class="p">):</span>

    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;sms.api&#39;</span>

    <span class="k">def</span> <span class="nf">_send_sms_nexmo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sms</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">sms</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="nd">@api</span><span class="o">.</span><span class="n">model</span>
    <span class="k">def</span> <span class="nf">_send_sms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">account</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;iap.account&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nexmo.sms&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">account</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">SmsApi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_send_sms</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="n">sms</span> <span class="o">=</span> <span class="n">Sms</span><span class="p">(</span><span class="n">Client</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">account</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="n">account</span><span class="o">.</span><span class="n">secret</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_sms_nexmo</span><span class="p">(</span><span class="n">sms</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="s1">&#39;Odoo&#39;</span><span class="p">,</span>
            <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="n">numbers</span><span class="p">,</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
        <span class="p">})</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id34">

<h3>Overwriting Odoo model: sms.api</h3>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@api</span><span class="o">.</span><span class="n">model</span>
<span class="k">def</span> <span class="nf">_send_sms_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">messages</span><span class="p">):</span>
    <span class="n">account</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;iap.account&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nexmo.sms&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">account</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">SmsApi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_send_sms_batch</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>

    <span class="n">sms</span> <span class="o">=</span> <span class="n">Sms</span><span class="p">(</span><span class="n">Client</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">account</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="n">account</span><span class="o">.</span><span class="n">secret</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_sms_nexmo</span><span class="p">(</span><span class="n">sms</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="s1">&#39;Odoo&#39;</span><span class="p">,</span>
            <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">],</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">],</span>
        <span class="p">})</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;messages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
            <span class="n">record</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">record</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>
    <span class="k">return</span> <span class="n">messages</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="integrate-customer-service-with-sms">

<h2>Integrate Customer Service with SMS</h2>

<p>Before getting your hands dirty and integrating our module with sms it is important that you understand some things.</p>
<ol class="arabic simple">
<li>When we changed the definition of our model so that it inherited from mail.thread. We made him acquire all the functionality of the email module.</li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomerServiceTicket</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;customer.service.ticket&#39;</span>
<span class="hll">    <span class="n">_inherit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;base.kanban.abstract&#39;</span><span class="p">,</span> <span class="s1">&#39;mail.thread&#39;</span><span class="p">]</span>
</span></pre></div>
</div>




</article>
<article class="slide level-2" id="id35">

<h2>Integrate Customer Service with SMS</h2>

<ol class="arabic simple" start="2">
<li>When installing the Odoo SA <strong>sms</strong> module we added new features to the mail.thread model, making Odoo records able to communicate via sms as well.</li>
<li>When we create a module sms_nexmo we change de default behavior of sending sms via Odoo SA IAP to send it via Nexmo.</li>
</ol>




</article>
<article class="slide level-3" id="send-customer-service-number-by-sms">

<h3>Send customer service number by SMS</h3>

<p>We will create a button to allow user to send ticket number to the partner by sms. But before that we will need the ticket number.</p>
<p>Lets add a sequence to our model, by creating:</p>
<ol class="arabic simple">
<li>Folder data at <strong>PROJECT_ROOT/odoo/local-src/customer_service/data</strong></li>
<li>A file: <strong>PROJECT_ROOT/odoo/local-src/customer_service/data/ir_sequence_data.xml</strong></li>
</ol>




</article>
<article class="slide level-3" id="id36">

<h3>Send customer service number by SMS</h3>

<ol class="arabic simple" start="3">
<li>Add it to the module manifest.</li>
</ol>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;odoo&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">noupdate=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="hll">
</span>        <span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;customer_service_sequence&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.sequence&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>CustomerService<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;code&quot;</span><span class="nt">&gt;</span>customer.service<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;prefix&quot;</span><span class="nt">&gt;</span>CS/<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;padding&quot;</span><span class="nt">&gt;</span>7<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/odoo&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id37">

<h3>Send customer service number by SMS</h3>

<p>Auto create a sequence when creating a new record:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">api</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">CustomerServiceTicket</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;customer.service.ticket&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;base.kanban.abstract&#39;</span><span class="p">,</span> <span class="s1">&#39;mail.thread&#39;</span><span class="p">]</span>

    <span class="n">_description</span> <span class="o">=</span> <span class="s1">&#39;Customer Service Ticket&#39;</span>  <span class="c1"># TODO</span>

<span class="hll">    <span class="n">code</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span>
</span>        <span class="n">readonly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;ir.sequence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">next_by_code</span><span class="p">(</span><span class="s1">&#39;customer.service&#39;</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">()</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Html</span><span class="p">(</span><span class="n">sanitize_style</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">user_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.users&#39;</span><span class="p">)</span>
    <span class="n">partner_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">)</span>
    <span class="n">partner_email</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">related</span><span class="o">=</span><span class="s1">&#39;partner_id.email&#39;</span><span class="p">)</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id38">

<h3>Send customer service number by SMS</h3>

<p>Add the new field to the form view:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_form_view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>customer.service.ticket.form (in customer_service)<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>customer.service.ticket<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form&gt;</span>
            <span class="nt">&lt;header&gt;</span>
                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;stage_id&quot;</span> <span class="na">widget=</span><span class="s">&quot;statusbar&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/header&gt;</span>
            <span class="nt">&lt;sheet&gt;</span>
                <span class="nt">&lt;group&gt;</span>
<span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;code&quot;</span><span class="nt">/&gt;</span>
</span>                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;user_id&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_id&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_email&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/group&gt;</span>
            <span class="nt">&lt;/sheet&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_chatter&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;message_follower_ids&quot;</span> <span class="na">widget=</span><span class="s">&quot;mail_followers&quot;</span> <span class="na">groups=</span><span class="s">&quot;base.group_user&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;message_ids&quot;</span> <span class="na">widget=</span><span class="s">&quot;mail_thread&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id39">

<h3>Send customer service number by SMS</h3>

<p>Add the new field to the tree view:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_tree_view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>customer.service.ticket.tree (in customer_service)<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>customer.service.ticket<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tree&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;code&quot;</span><span class="nt">/&gt;</span>
</span>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;user_id&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_id&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/tree&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="creating-a-button-to-send-sms">

<h3>Creating a button to send sms</h3>

<ol class="arabic simple">
<li>Add the button to the view</li>
<li>Create the method at the model</li>
</ol>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;customer_service_ticket_form_view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>customer.service.ticket.form (in customer_service)<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>customer.service.ticket<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form&gt;</span>
            <span class="nt">&lt;header&gt;</span>
                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;stage_id&quot;</span> <span class="na">widget=</span><span class="s">&quot;statusbar&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;send_number_by_sms&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span> <span class="na">string=</span><span class="s">&quot;Send Object by SMS&quot;</span><span class="nt">/&gt;</span>
</span>            <span class="nt">&lt;/header&gt;</span>
            <span class="nt">&lt;sheet&gt;</span>
                <span class="nt">&lt;group&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;code&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;user_id&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_id&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;partner_email&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/group&gt;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id40">

<h3>Creating a button to send sms</h3>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">api</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">CustomerServiceTicket</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;customer.service.ticket&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;base.kanban.abstract&#39;</span><span class="p">,</span> <span class="s1">&#39;mail.thread&#39;</span><span class="p">]</span>

    <span class="n">_description</span> <span class="o">=</span> <span class="s1">&#39;Customer Service Ticket&#39;</span>  <span class="c1"># TODO</span>

<span class="hll">    <span class="n">code</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span>
</span><span class="hll">        <span class="n">readonly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span class="hll">        <span class="n">default</span><span class="o">=</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;ir.sequence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">next_by_code</span><span class="p">(</span><span class="s1">&#39;customer.service&#39;</span><span class="p">))</span>
</span><span class="hll">    <span class="p">)</span>
</span>    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">()</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Html</span><span class="p">(</span><span class="n">sanitize_style</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">user_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.users&#39;</span><span class="p">)</span>
    <span class="n">partner_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">)</span>
    <span class="n">partner_email</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">related</span><span class="o">=</span><span class="s1">&#39;partner_id.email&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_number_by_sms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">record</span><span class="o">.</span><span class="n">_message_sms</span><span class="p">(</span>
                <span class="s1">&#39;OCA days: Your ticket number is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">code</span><span class="p">),</span>
                <span class="n">partner_ids</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">partner_id</span><span class="o">.</span><span class="n">ids</span>
            <span class="p">)</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="seding-your-module-to-the-oca">

<h2>Seding your module to the OCA</h2>

<ol class="arabic simple">
<li>Commit</li>
<li>Push to the fork</li>
<li>Create a pull request</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>To learn more:</dt><dd><ul class="simple">
<li>Check the OCA guidelines: <a class="reference external" href="https://github.com/OCA/odoo-community.org/blob/master/website/Contribution/CONTRIBUTING.rst">https://github.com/OCA/odoo-community.org/blob/master/website/Contribution/CONTRIBUTING.rst</a></li>
</ul>
</dd>
</dl>
</div>




</article>
<article class="slide level-2" id="review">

<h2>Review</h2>

<ol class="arabic simple">
<li>Setup your project from a project template;</li>
<li>Use OCA modules;</li>
<li>Create your own module;</li>
<li>Create an OCA module;</li>
</ol>




</article>
<article class="slide level-1" id="questions-and-answers">

<h1>Questions and answers</h1>





</article>
<article class="slide level-2" id="thank-you-to-the-oca-sponsors">

<h2>Thank you to the OCA Sponsors</h2>

<a class="reference internal image-reference" href="_images/sponsors.jpg"><img alt="_images/sponsors.jpg" class="align-center" src="_images/sponsors.jpg" style="width: 550px; height: 500px;" /></a>




</article>

</section>

<section id="slide_notes">

</section>

  </body>
</html>